<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Matthew Bain" />


<title>Plotting roadmap</title>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="shortcut icon" href="favicon.jpg">

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { color: #585cf6; } /* Constant */
code span.co { color: #4c886b; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dv { color: #0000cd; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cd; } /* Float */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { color: #687687; } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #036a07; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="generic-css.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">data-driven-brain</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    data guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">--- tours ---</li>
    <li class="dropdown-header">Classification in R</li>
    <li class="dropdown-header">Classification in Python</li>
    <li class="dropdown-header">Frequentist hypothesis testing in R</li>
    <li class="dropdown-header">--- templates ---</li>
    <li class="dropdown-header">Writing template</li>
    <li class="dropdown-header">Plotting roadmap</li>
    <li class="dropdown-header">--- worked ---</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    data projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">[placeholder]</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    math
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">[placeholder]</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    machines
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">[placeholder]</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    art
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">[placeholder]</li>
  </ul>
</li>
<li>
  <a href="music_page.html">original music</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mattlabcode">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.linkedin.com/in/matthew-bain314/">
    <span class="fab fa-linkedin fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.youtube.com/@fujinai9/featured">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://soundcloud.com/user-752823440">
    <span class="fa fa-brands fa-soundcloud"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Plotting roadmap</h1>
<h4 class="author">Matthew Bain</h4>

</div>


<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Establish project paths</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>root <span class="op">=</span> <span class="st">&#39;/content/drive/MyDrive/Colab_Notebooks/&#39;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>project_dir <span class="op">=</span> <span class="st">&#39;experiments/&#39;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>output_dir  <span class="op">=</span> <span class="st">&#39;stylesheet_tests/&#39;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>project_path <span class="op">=</span> root <span class="op">+</span> project_dir</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>output_path <span class="op">=</span> root <span class="op">+</span> project_dir <span class="op">+</span> output_dir</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>env_path <span class="op">=</span> project_path <span class="op">+</span> <span class="st">&#39;requirements.txt&#39;</span></span></code></pre></div>
<div id="global-settings" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Global settings</h1>
<p><strong>Visual elements and parameters I consider when establishing
defaults</strong></p>
<div class="figure" style="text-align: center">
<img src="images/attribute_histogram_plots.png" alt="Caption" width="100%" />
<p class="caption">
Caption
</p>
</div>
<pre><code>#&gt;      Name Age Score
#&gt; 1   Alice  25    85
#&gt; 2     Bob  30    92
#&gt; 3 Charlie  22    78</code></pre>
<table>
<caption>Caption</caption>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="right">Age</th>
<th align="right">Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alice</td>
<td align="right">25</td>
<td align="right">85</td>
</tr>
<tr class="even">
<td align="left">Bob</td>
<td align="right">30</td>
<td align="right">92</td>
</tr>
<tr class="odd">
<td align="left">Charlie</td>
<td align="right">22</td>
<td align="right">78</td>
</tr>
</tbody>
</table>
<p><em>Generic</em></p>
<ul>
<li><code>text</code> (x/y/title/tick labels/legend title/legend items):
font face/size</li>
<li><code>axes</code>: which to display/linewidth/minMax tick
sizes/minMax tick widths</li>
<li><code>grid</code>: which minMax VerticalHorizontal lines to
display/colour/linewidth</li>
<li><code>object</code>: edgecolour/edgewidth</li>
<li><code>colours</code>: discrete cycle/continuous map</li>
<li><code>legend</code>: box/placement</li>
<li><code>figure</code>: size</li>
<li><code>subplots</code>: vertical padding/horizontal padding</li>
<li><code>other</code>: layout compactness, display quality</li>
</ul>
<p><em>Additional specifications for particular objects</em></p>
<ul>
<li><code>scatter</code>: marker size</li>
<li><code>line</code>: width/continuous error colour/continuous error
linewidth</li>
<li><code>bar</code>: width/between group spacing/errorbar
colour/errorbar linewidth/errorbar cap width</li>
<li><code>grouped bar</code>: within group spacing</li>
<li><code>box</code>: median colour/median width</li>
</ul>
<p><em>Note: for each of the above, despite generic <code>object</code>
defaults, may additionally have to specify:</em> -
edgecolour/edgewidth</p>
<p><em>Parameters to consider manually specifying for each
(sub)plot:</em></p>
<ul>
<li><code>labels/title</code>: on or off</li>
<li><code>tick labels</code>: rotation, which ticks</li>
<li><code>axes</code>: limits, which ticks</li>
<li><code>grid</code>: which lines</li>
<li><code>object</code>: alpha</li>
<li><code>figure</code>: size</li>
<li><code>subplots</code>: RowColPosition arrangement, (shared)
labels/titles</li>
</ul>
<p><em>Typical plotting function arguments:</em></p>
<ul>
<li>data, fill variable, size variable</li>
<li>plot type, error type, kernel type, regression type</li>
<li>bin/sampling resolution</li>
</ul>
<p><strong>References</strong> - <a
href="https://matplotlib.org/stable/users/explain/customizing.html#the-matplotlibrc-file">The
matplotlibrc file - matplotlib.org</a></p>
<p><strong>Note</strong> - All lines in the <code>matplotlibrc</code>
file start with a ‘#’, so that removing all leading ’#’s yields a valid
style file</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">### [SCRATCH] Get fonts</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> font_manager <span class="im">as</span> fm</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fontTools.ttLib <span class="im">import</span> TTFont</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># !wget &#39;https://github.com/google/fonts/blob/main/ofl/allison/Allison-Regular.ttf&#39;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>font_file <span class="op">=</span> Path(<span class="op">*</span>fm.findSystemFonts(<span class="st">&#39;.&#39;</span>))</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>font_file_path <span class="op">=</span> Path(font_file)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># fm.fontManager.addfont(font_file_path) # [</span><span class="al">TODO</span><span class="co">] resolve this</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">### [SCRATCH]</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>item <span class="op">=</span> <span class="st">&#39;Abel-Regular.ttf&#39;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>overwrite <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>source_path <span class="op">=</span> os.path.join(<span class="st">&#39;/content/&#39;</span>, item)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>output_path <span class="op">=</span> os.path.join(project_path, output_dir, item)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Copying: </span><span class="sc">{</span>item<span class="sc">}</span><span class="ss"> from </span><span class="sc">{</span>source_path<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>output_path<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> os.path.isfile(source_path) <span class="kw">or</span> os.path.isdir(source_path):</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if the item already exists in the output path</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> os.path.exists(output_path):</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> overwrite:</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Copy the item</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>            <span class="co">#!cp -rf &quot;$source_path&quot; &quot;$output_path&quot;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Successfully copied </span><span class="sc">{</span>item<span class="sc">}</span><span class="ss"> -&gt;</span><span class="ch">\n</span><span class="sc">{</span>output_path<span class="sc">}</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f&quot;Skipped: </span><span class="sc">{</span>item<span class="sc">}</span><span class="ss"> already exists in </span><span class="sc">{</span>output_path<span class="sc">}</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Copy the item</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="co">#!cp -rf &quot;$source_path&quot; &quot;$output_path&quot;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&quot;Successfully copied </span><span class="sc">{</span>item<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>output_path<span class="sc">}</span><span class="ch">\n</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">### [SCRATCH]</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># !pip install pipreqs</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># !pipreqs &gt; requirements.txt --force</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">### View path to base matplotlibrc file</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>matplotlib.matplotlib_fname()</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">### STYLESHEET TEMPLATE</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># font.family : &#39;sans&#39;</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Stylesheet. Contrast with https://matplotlib.org/stable/users/explain/customizing.html#the-matplotlibrc-file</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> ListedColormap</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">## General</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Font face and sizes</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;font.family&#39;</span>] <span class="op">=</span> <span class="st">&#39;sans-serif&#39;</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;font.sans-serif&#39;] = &quot;Helvetica&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;font.size&#39;</span>] <span class="op">=</span> <span class="dv">8</span>             <span class="co"># default font sizes</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.titlesize&#39;</span>] <span class="op">=</span> <span class="dv">12</span>       <span class="co"># large</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.labelsize&#39;</span>] <span class="op">=</span> <span class="dv">9</span>        <span class="co"># medium</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;xtick.labelsize&#39;</span>] <span class="op">=</span> <span class="dv">8</span>       <span class="co"># medium</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;ytick.labelsize&#39;</span>] <span class="op">=</span> <span class="dv">8</span>       <span class="co"># medium</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;legend.fontsize&#39;</span>] <span class="op">=</span> <span class="dv">9</span>       <span class="co"># medium</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;legend.title_fontsize&#39;</span>] <span class="op">=</span> <span class="dv">9</span> <span class="co"># None (same as default axes)</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;figure.titlesize&#39;</span>] <span class="op">=</span> <span class="dv">15</span>     <span class="co"># large (suptitle size)</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;figure.labelsize&#39;</span>] <span class="op">=</span> <span class="dv">12</span>     <span class="co"># large (sup[x|y]label size)</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Spines and ticks</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;axes.spines.top&#39;] = False</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;axes.spines.right&#39;] = False</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.linewidth&#39;</span>] <span class="op">=</span> <span class="fl">.6</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.edgecolor&#39;</span>] <span class="op">=</span> <span class="st">&#39;black&#39;</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;xtick.major.size&#39;</span>] <span class="op">=</span> <span class="dv">0</span> <span class="co"># 3.5</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;ytick.major.size&#39;</span>] <span class="op">=</span> <span class="dv">0</span> <span class="co"># 3.5</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;xtick.major.width&#39;] =  0.8</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;ytick.major.width&#39;] =  0.8</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Grid</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.grid.which&#39;</span>] <span class="op">=</span> <span class="st">&#39;major&#39;</span> <span class="co"># lines at {major, minor, both} ticks</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;grid.linestyle&#39;</span>] <span class="op">=</span> <span class="st">&#39;--&#39;</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;grid.color&#39;</span>] <span class="op">=</span> <span class="st">&#39;#CCCCCC&#39;</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;grid.linewidth&#39;</span>] <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;grid.alpha&#39;] = 1</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a><span class="co"># Label placement</span></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.titlelocation&#39;</span>] <span class="op">=</span> <span class="st">&#39;center&#39;</span> <span class="co"># {left, right, center}</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.titlepad&#39;</span>] <span class="op">=</span> <span class="fl">7.5</span> <span class="co"># 6</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.labelpad&#39;</span>] <span class="op">=</span> <span class="fl">7.5</span> <span class="co"># 4</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;xtick.major.pad&#39;] = 3.5 # distance to major tick label in points</span></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;ytick.major.pad&#39;] = 3.5</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Discrete color cycle (and continuous map)</span></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;axes.prop_cycle&#39;] = mpl.cycler(color=[&#39;#1f77b4&#39;, &#39;#ff7f0e&#39;, &#39;#2ca02c&#39;, &#39;#d62728&#39;])</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;axes.prop_cycle&#39;</span>] <span class="op">=</span> mpl.cycler(color<span class="op">=</span>sns.color_palette(<span class="st">&quot;PiYG&quot;</span>, n_colors<span class="op">=</span><span class="dv">6</span>))</span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend properties</span></span>
<span id="cb8-51"><a href="#cb8-51" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;legend.loc&#39;</span>] <span class="op">=</span> <span class="st">&#39;best&#39;</span></span>
<span id="cb8-52"><a href="#cb8-52" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;legend.frameon&#39;</span>] <span class="op">=</span> <span class="va">False</span></span>
<span id="cb8-53"><a href="#cb8-53" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;legend.loc&#39;</span>] <span class="op">=</span> <span class="st">&#39;best&#39;</span></span>
<span id="cb8-54"><a href="#cb8-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-55"><a href="#cb8-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Legend padding</span></span>
<span id="cb8-56"><a href="#cb8-56" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;legend.borderpad&#39;] =  0.4     # border whitespace</span></span>
<span id="cb8-57"><a href="#cb8-57" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;legend.labelspacing&#39;] = 0.5   # vert space between legend entries</span></span>
<span id="cb8-58"><a href="#cb8-58" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;legend.handlelength&#39;] = 2.0   # length of the legend lines</span></span>
<span id="cb8-59"><a href="#cb8-59" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;legend.handleheight&#39;] = 0.7   # height of the legend handle</span></span>
<span id="cb8-60"><a href="#cb8-60" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;legend.handletextpad&#39;] = 0.8  # space btwn legend line legend text</span></span>
<span id="cb8-61"><a href="#cb8-61" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;legend.borderaxespad&#39;] = 0.5  # border btwn axes and legend edge</span></span>
<span id="cb8-62"><a href="#cb8-62" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;legend.columnspacing&#39;] = 2.0  # column separation</span></span>
<span id="cb8-63"><a href="#cb8-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-64"><a href="#cb8-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Space-filling object properties (e.g., polygons/circles, scatter)</span></span>
<span id="cb8-65"><a href="#cb8-65" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;patch.edgecolor&#39;</span>] <span class="op">=</span> <span class="st">&#39;blue&#39;</span> <span class="co"># if forced, else patch is not filled</span></span>
<span id="cb8-66"><a href="#cb8-66" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;patch.force_edgecolor&#39;</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-67"><a href="#cb8-67" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;patch.linewidth&#39;</span>] <span class="op">=</span> <span class="dv">0</span> <span class="co"># edgewidth (.5)</span></span>
<span id="cb8-68"><a href="#cb8-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-69"><a href="#cb8-69" aria-hidden="true" tabindex="-1"></a><span class="co">## Specific objects</span></span>
<span id="cb8-70"><a href="#cb8-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter properties</span></span>
<span id="cb8-71"><a href="#cb8-71" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;scatter.edgecolors&#39;] = &#39;black&#39;</span></span>
<span id="cb8-72"><a href="#cb8-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-73"><a href="#cb8-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Line properties</span></span>
<span id="cb8-74"><a href="#cb8-74" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;lines.markersize&#39;</span>] <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb8-75"><a href="#cb8-75" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;lines.linewidth&#39;</span>] <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb8-76"><a href="#cb8-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-77"><a href="#cb8-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar properties</span></span>
<span id="cb8-78"><a href="#cb8-78" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;bar.width&#39;] = 0.8</span></span>
<span id="cb8-79"><a href="#cb8-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-80"><a href="#cb8-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Error properties</span></span>
<span id="cb8-81"><a href="#cb8-81" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;errorbar.capsize&#39;</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-82"><a href="#cb8-82" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;errorbar.color&#39;] = &#39;black&#39;</span></span>
<span id="cb8-83"><a href="#cb8-83" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;errorbar.linewidth&#39;] = 1.5</span></span>
<span id="cb8-84"><a href="#cb8-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-85"><a href="#cb8-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Box properties</span></span>
<span id="cb8-86"><a href="#cb8-86" aria-hidden="true" tabindex="-1"></a><span class="co"># box</span></span>
<span id="cb8-87"><a href="#cb8-87" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.boxprops.linewidth&#39;</span>] <span class="op">=</span> <span class="dv">0</span> <span class="co"># box outline (0.5)</span></span>
<span id="cb8-88"><a href="#cb8-88" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.boxprops.color&#39;] = &#39;none&#39; # &#39;black&#39; (?)</span></span>
<span id="cb8-89"><a href="#cb8-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-90"><a href="#cb8-90" aria-hidden="true" tabindex="-1"></a><span class="co"># box line to cap</span></span>
<span id="cb8-91"><a href="#cb8-91" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.whiskerprops.linewidth&#39;</span>] <span class="op">=</span> <span class="fl">.65</span></span>
<span id="cb8-92"><a href="#cb8-92" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.whiskerprops.linestyle&#39;</span>] <span class="op">=</span> <span class="st">&#39;--&#39;</span></span>
<span id="cb8-93"><a href="#cb8-93" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.whiskerprops.color&#39;] = &#39;black&#39; # (?)</span></span>
<span id="cb8-94"><a href="#cb8-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-95"><a href="#cb8-95" aria-hidden="true" tabindex="-1"></a><span class="co"># box cap line</span></span>
<span id="cb8-96"><a href="#cb8-96" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.capprops.linewidth&#39;</span>] <span class="op">=</span> <span class="fl">.75</span></span>
<span id="cb8-97"><a href="#cb8-97" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.capprops.color&#39;] = &#39;black&#39; # (?)</span></span>
<span id="cb8-98"><a href="#cb8-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-99"><a href="#cb8-99" aria-hidden="true" tabindex="-1"></a><span class="co"># box median line</span></span>
<span id="cb8-100"><a href="#cb8-100" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.medianprops.linewidth&#39;</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-101"><a href="#cb8-101" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.medianprops.linestyle&#39;</span>] <span class="op">=</span> <span class="st">&#39;-&#39;</span></span>
<span id="cb8-102"><a href="#cb8-102" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.medianprops.color&#39;] = &#39;black&#39; # (?)</span></span>
<span id="cb8-103"><a href="#cb8-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-104"><a href="#cb8-104" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.meanprops.linewidth&#39;</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb8-105"><a href="#cb8-105" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.meanprops.linestyle&#39;</span>] <span class="op">=</span> <span class="st">&#39;-&#39;</span></span>
<span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.meanprops.color&#39;] = &#39;black&#39; # (?)</span></span>
<span id="cb8-107"><a href="#cb8-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-108"><a href="#cb8-108" aria-hidden="true" tabindex="-1"></a><span class="co"># box scatter</span></span>
<span id="cb8-109"><a href="#cb8-109" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.flierprops.markerfacecolor&#39;</span>] <span class="op">=</span> <span class="st">&#39;none&#39;</span></span>
<span id="cb8-110"><a href="#cb8-110" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.flierprops.markeredgewidth&#39;</span>] <span class="op">=</span> <span class="fl">.65</span></span>
<span id="cb8-111"><a href="#cb8-111" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;boxplot.flierprops.marker&#39;</span>] <span class="op">=</span> <span class="st">&#39;o&#39;</span></span>
<span id="cb8-112"><a href="#cb8-112" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.flierprops.markersize&#39;] = 6 # (?)</span></span>
<span id="cb8-113"><a href="#cb8-113" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.flierprops.linewidth&#39;] = 0 # (?)</span></span>
<span id="cb8-114"><a href="#cb8-114" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.flierprops.markeredgecolor&#39;] = &#39;black&#39; # (?)</span></span>
<span id="cb8-115"><a href="#cb8-115" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;boxplot.flierprops.color&#39;] = &#39;black&#39; # (?)</span></span>
<span id="cb8-116"><a href="#cb8-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-117"><a href="#cb8-117" aria-hidden="true" tabindex="-1"></a><span class="co">## Figure padding</span></span>
<span id="cb8-118"><a href="#cb8-118" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure layout</span></span>
<span id="cb8-119"><a href="#cb8-119" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;figure.autolayout&#39;</span>] <span class="op">=</span> <span class="va">True</span> <span class="co"># auto- make plot elements fit on fig</span></span>
<span id="cb8-120"><a href="#cb8-120" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;figure.constrained_layout.use&#39;</span>] <span class="op">=</span> <span class="va">True</span> <span class="co"># apply tight layout</span></span>
<span id="cb8-121"><a href="#cb8-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-122"><a href="#cb8-122" aria-hidden="true" tabindex="-1"></a><span class="co"># Subplot padding (all dims are a fraction of the fig width and height).</span></span>
<span id="cb8-123"><a href="#cb8-123" aria-hidden="true" tabindex="-1"></a><span class="co"># Not compatible with constrained_layout.</span></span>
<span id="cb8-124"><a href="#cb8-124" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.subplot.left&#39;] = .125   # left side of subplots of fig</span></span>
<span id="cb8-125"><a href="#cb8-125" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.subplot.right&#39;] = 0.9    # right side of subplots of fig</span></span>
<span id="cb8-126"><a href="#cb8-126" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.subplot.bottom&#39;] = 0.11  # bottom of subplots of fig</span></span>
<span id="cb8-127"><a href="#cb8-127" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.subplot.top&#39;] = 0.88     # top of subplots of figure</span></span>
<span id="cb8-128"><a href="#cb8-128" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.subplot.wspace&#39;] = 0.2   # w reserved space btwn subplots</span></span>
<span id="cb8-129"><a href="#cb8-129" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.subplot.hspace&#39;] = 0.2   # h reserved space btwn subplots</span></span>
<span id="cb8-130"><a href="#cb8-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-131"><a href="#cb8-131" aria-hidden="true" tabindex="-1"></a><span class="co"># Constrained layout padding. Not compatible with autolayout.</span></span>
<span id="cb8-132"><a href="#cb8-132" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.constrained_layout.h_pad&#39;] = 0.04167</span></span>
<span id="cb8-133"><a href="#cb8-133" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.constrained_layout.w_pad&#39;] = 0.04167</span></span>
<span id="cb8-134"><a href="#cb8-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-135"><a href="#cb8-135" aria-hidden="true" tabindex="-1"></a><span class="co"># Constrained layout spacing between subplots, relative to the subplot sizes.</span></span>
<span id="cb8-136"><a href="#cb8-136" aria-hidden="true" tabindex="-1"></a><span class="co"># Much smaller than for tight_layout (figure.subplot.hspace, figure.subplot.wspace)</span></span>
<span id="cb8-137"><a href="#cb8-137" aria-hidden="true" tabindex="-1"></a><span class="co"># as constrained_layout already takes surrounding text (titles, labels, # ticklabels)</span></span>
<span id="cb8-138"><a href="#cb8-138" aria-hidden="true" tabindex="-1"></a><span class="co"># into account. Not compatible with autolayout.</span></span>
<span id="cb8-139"><a href="#cb8-139" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.constrained_layout.hspace&#39;] = 0.02</span></span>
<span id="cb8-140"><a href="#cb8-140" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;figure.constrained_layout.wspace&#39;] = 0.02</span></span>
<span id="cb8-141"><a href="#cb8-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-142"><a href="#cb8-142" aria-hidden="true" tabindex="-1"></a><span class="co">## Other</span></span>
<span id="cb8-143"><a href="#cb8-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure size and quality</span></span>
<span id="cb8-144"><a href="#cb8-144" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;figure.dpi&#39;</span>] <span class="op">=</span> <span class="dv">100</span> <span class="co"># [</span><span class="al">NOTE</span><span class="co">] alters figure size</span></span>
<span id="cb8-145"><a href="#cb8-145" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;figure.figsize&#39;</span>] <span class="op">=</span> (<span class="dv">5</span>, <span class="dv">5</span>) <span class="co"># (6, 4), (6.4, 4.8)</span></span>
<span id="cb8-146"><a href="#cb8-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-147"><a href="#cb8-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Figure saving settings</span></span>
<span id="cb8-148"><a href="#cb8-148" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;savefig.transparent&#39;</span>] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb8-149"><a href="#cb8-149" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;savefig.format&#39;</span>] <span class="op">=</span> <span class="st">&#39;png&#39;</span></span>
<span id="cb8-150"><a href="#cb8-150" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;savefig.dpi&#39;</span>] <span class="op">=</span> <span class="dv">330</span></span>
<span id="cb8-151"><a href="#cb8-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-152"><a href="#cb8-152" aria-hidden="true" tabindex="-1"></a><span class="co">#%config InlineBackend.figure_format = &#39;svg&#39; # set inline figure format/quality</span></span></code></pre></div>
</div>
<div id="colours" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Colours</h1>
<p>[TODO]</p>
<p><strong>Colour palette generator utilities</strong></p>
<p>[TODO] [def] Continuous generators:</p>
<p>(1 H nodes) Monchromatic (linear L) - args: 1 H node, optional n L
steps from it - example: <code>blues</code> - utility: topological - use
cases: surface/distribution/contour plot</p>
<p>(~2-6 H nodes) Sequential (constant L): - args: 2-6 H nodes, optional
n(k - 1) transition steps between them - example:
<code>viridis/plasma</code> - utility: topological - use cases:
surface/distribution/contour plot</p>
<p>(2 H nodes) Diverging (triangular L): - args: 2 H nodes, optional n*2
ascending/descending L steps between them - example:
<code>PiYG/RdBu</code> - utility: 1D bipolar scale/2D binary probability
surface - use cases: heatmap, classifier decision surface</p>
<p>(~3-6 H nodes) Sequential diverging (~triangular L) - args: k H
nodes, optional n(k - 1)*2 ascending/descending L steps between them -
example: ~<code>gnuplot2/gist_ncar/gist_rainbow/jet</code> - utility: 1D
multipolar scale - use cases: heatmap with 1+ intermediate nodes</p>
<p>/ (~6 H nodes) Spectral (~constant L, cyclic /H) - example:
<code>hsv</code> - utility: multiclass probability surface (using class
probability-weighted H nodes) - ues cases: multiclass classifier
decision surface</p>
<p>[TODO] [def] Discrete generators:</p>
<p>(k H nodes) Discrete (~constant L) - args: k H nodes - example:
<code>tab10/Dark2</code> - utility: discrete objects with no
within-group levels OR groups of objects with within-group levels but no
order - use cases: k objects (lines/hists/bars/boxplots) for k
categories OR m objects (within groups) for m levels</p>
<p>(k H nodes) Discrete monochromatic (~constant L between * linear L
within) - args: k H nodes, optional n*k L steps from each node -
example: <code>tab20/paired</code> &gt; <code>tab20c/tab20b</code> -
utility: discrete groups of objects with a within-group order and aim to
highlight between-group differences - use cases: (group * time period) *
value grouped objects (lines/hists/bars/boxplots)</p>
<p><strong>Colour generator utillity</strong></p>
<p>Given (a) any H value and k-iary scheme / (b) H/set of H values and
integer k: - (a) [def] return complimentary/triad/square/k-iary H nodes
- (b) [def] return k quantized H nodes</p>
<p>[TODO] For all of the above: - args: accept k colours and optional n
steps - convert inputs to H values [0-359] - (maximize S/L of input
args) - if multiple H nodes passed, quantize so each evenly spaced on
colorwheel - return: k H nodes (+ either colourmap or discrete
colourset) - plot: H nodes on <a
href="https://matplotlib.org/stable/gallery/pie_and_polar_charts/polar_scatter.html#sphx-glr-gallery-pie-and-polar-charts-polar-scatter-py">colourwheel</a>
(+ colourbar)</p>
<p>[TODO] Other: - demo how to convert any map hsl values</p>
<p>[REF] Tools - <a
href="https://color.adobe.com/create/color-wheel">Adobe
Colorwheel</a></p>
<p>Matplotlib - <a
href="https://matplotlib.org/stable/users/explain/colors/colormaps.html#mycarta-jet">Choosing
Colormaps</a> - <a
href="https://matplotlib.org/stable/users/explain/colors/colormap-manipulation.html">Creating
Colormaps</a></p>
<p>Other libraries - <a
href="https://seaborn.pydata.org/tutorial/color_palettes.html">seaborn</a>
- <a
href="https://cmasher.readthedocs.io/user/introduction.html">CMasher</a>
- <a href="https://pratiman-91.github.io/colormaps/">Colormaps</a> - <a
href="https://jiffyclub.github.io/palettable/#finding-palettes">Palettable</a></p>
<p>Theory - Standard color space: <a
href="https://en.wikipedia.org/wiki/HSL_and_HSV">HSL and HSV -
Wikipedia</a> - Perceptually uniform color space: <a
href="https://hclwizard.org/why-hcl/">HCL - hclwizard</a> -
Human-friendly HSL! : <a href="https://www.hsluv.org/">HSLuv -
HSLuv.org</a></p>
<p>Other - Reference of good perceptual palettes: <a
href="https://colorspace.r-forge.r-project.org/articles/hcl_palettes.html">HCL-Based
Color Palettes - colorspace</a></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install cmasher</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Continuous maps</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Monochromatic (1 H, linear L)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#import cmasher as cmr</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;Blues_r&#39;, 0, 1, N=20)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;Greens_r&#39;, 0, 1, N=20)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Sequential (multiple H, constant L)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;plasma&#39;, 0, 1, N=20)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;cmr.chroma&#39;, 0.2, .8, N=20)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Constructing monochromatic (rot=.1)/sequential/cyclic (rot=1) maps w/ linear L</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># starting H [0, 3] (ROYGBIV = 3/7*h), rotations around hue wheel (int)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dark/light (intensity of darkest/lightest color in palette) [0, 1] or gamma</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ListedColormap(sns.cubehelix_palette(start<span class="op">=</span>(<span class="dv">3</span><span class="op">/</span><span class="dv">7</span>)<span class="op">*</span><span class="dv">1</span>, rot<span class="op">=</span><span class="fl">.1</span>, reverse<span class="op">=</span><span class="va">True</span>, gamma<span class="op">=</span><span class="fl">.7</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="co"># dark=.25, light=.85,</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                                     n_colors<span class="op">=</span><span class="dv">20</span>, as_cmap<span class="op">=</span><span class="va">False</span>))</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Diverging (~2 H, triangular L)</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;PiYG&#39;, 0, 1, N=20)</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;Spectral&#39;, 0, 1, N=20)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) Sequentially diverging (3-6 H, ~triangular L)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;gnuplot&#39;, 0, 1, N=20)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Constructing diverging/sequentially diverging map</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># starting/ending H [0, 359], S [0, 100], L [0, 100]</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>n_colors <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>palette_1 <span class="op">=</span> sns.diverging_palette(h_neg<span class="op">=</span><span class="dv">100</span>, h_pos<span class="op">=</span><span class="dv">200</span>, s<span class="op">=</span><span class="dv">100</span>, l<span class="op">=</span><span class="dv">50</span>, n<span class="op">=</span>n_colors, as_cmap<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>palette_1 <span class="op">=</span> ListedColormap(palette_1)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>palette_1</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>palette_2 <span class="op">=</span> sns.diverging_palette(h_neg<span class="op">=</span><span class="dv">200</span>, h_pos<span class="op">=</span><span class="dv">300</span>, s<span class="op">=</span><span class="dv">100</span>, l<span class="op">=</span><span class="dv">50</span>, n<span class="op">=</span>n_colors, as_cmap<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>palette_2 <span class="op">=</span> ListedColormap(palette_2)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>palette_2</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>palette_combined <span class="op">=</span> np.vstack((</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    palette_1(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, n_colors)),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    palette_2(np.linspace(<span class="dv">1</span><span class="op">/</span>n_colors, <span class="dv">1</span>, n_colors <span class="op">-</span> <span class="dv">1</span>))))</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>ListedColormap(palette_combined, name<span class="op">=</span><span class="st">&#39;GrBlPu&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Spectral (cyclic H, ~constant L)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ListedColormap(sns.color_palette(<span class="st">&quot;husl&quot;</span>, n_colors<span class="op">=</span><span class="dv">10</span>, as_cmap<span class="op">=</span><span class="va">False</span>))</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;hsv&#39;, 0, 1, N=20)</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Discrete maps</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.get_sub_cmap(&#39;tab20b&#39;, 0, 1, N=20)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.cm.tab20b</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Constructing discrete monochromatic map (hue-grouped truncated discrete map)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>n_groups <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>n_bars <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> plt.cm.tab20b((</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>     <span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>     <span class="dv">16</span>,<span class="dv">17</span>,<span class="dv">18</span>])).reshape(n_groups, n_bars, <span class="dv">4</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>ListedColormap(colors.reshape(n_groups <span class="op">*</span> n_bars, <span class="dv">4</span>))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ListedColormap(colors[0, :])</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Obtain hex/rgb string codes for specified colourmap</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># return_fmt {hex, float=rgb}</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#cmr.take_cmap_colors(&#39;cmr.chroma&#39;, cmap_range=(0, 1), N=20, return_fmt=&#39;float&#39;)</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">###</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] legend has 1st colour of each group; xaxis has rotated labels of 3*3</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> (<span class="st">&quot;Adelie&quot;</span>, <span class="st">&quot;Chinstrap&quot;</span>, <span class="st">&quot;Gentoo&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bill Depth&#39;</span>: (<span class="fl">18.35</span>, <span class="fl">18.43</span>, <span class="fl">14.98</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bill Length&#39;</span>: (<span class="fl">38.79</span>, <span class="fl">48.83</span>, <span class="fl">47.50</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Flipper Length&#39;</span>: (<span class="fl">189.95</span>, <span class="fl">195.82</span>, <span class="fl">217.19</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(species))  <span class="co"># the label locations</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># the width of the bars</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>multiplier <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(layout<span class="op">=</span><span class="st">&#39;constrained&#39;</span>)</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group, (attribute, measurement) <span class="kw">in</span> <span class="bu">enumerate</span>(data.items()):</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> width <span class="op">*</span> multiplier</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    rects <span class="op">=</span> ax.bar(x <span class="op">+</span> offset, measurement, width, alpha<span class="op">=</span><span class="fl">.85</span>,</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>attribute.lower().capitalize(),</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span>colors[:, group])</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    ax.bar_label(rects, padding<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    multiplier <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>)<span class="op">;</span> ax.legend(ncols<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">250</span>)</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(x <span class="op">+</span> width, species)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Length (mm)&#39;</span>)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Whitepaper plot&#39;</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="tools-for-data-representation-manipulation"
class="section level1" number="3">
<h1><span class="header-section-number">3</span> Tools for data
representation &amp; manipulation</h1>
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">### [def] Utilities for visualizing df and LA operations</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [REF] Vanderplas; [MB] adapted to handle numpy arrays</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.linalg <span class="im">as</span> la</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> display(<span class="bu">object</span>):</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">&quot;&quot;&quot;Display HTML representation of multiple objects&quot;&quot;&quot;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  template <span class="op">=</span> <span class="st">&quot;&quot;&quot;&lt;div style=&quot;float: left; padding: 10px;&quot;&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="st">  &lt;p style=&#39;font-family:&quot;Courier New&quot;, Courier, monospace&#39;&gt;</span><span class="sc">{0}{1}</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="st">  &quot;&quot;&quot;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, <span class="op">*</span>args):</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="va">self</span>.args <span class="op">=</span> args</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="kw">def</span> <span class="fu">__repr__</span>(<span class="va">self</span>):</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>.join(</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span> <span class="op">+</span> <span class="st">&#39;</span><span class="ch">\033</span><span class="st">[1m&#39;</span> <span class="op">+</span> a <span class="op">+</span> <span class="st">&#39;</span><span class="ch">\033</span><span class="st">[0m&#39;</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span> <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> <span class="bu">repr</span>(np.shape(<span class="bu">eval</span>(a))) <span class="op">+</span> <span class="st">&#39; &#39;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">+</span> <span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span> <span class="op">+</span> <span class="bu">repr</span>(np.<span class="bu">round</span>(<span class="bu">eval</span>(a), <span class="dv">2</span>))</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> a <span class="kw">in</span> <span class="va">self</span>.args</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> make_df(cols, ind):</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">&quot;&quot;&quot;Quickly make a DataFrame&quot;&quot;&quot;</span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  data <span class="op">=</span> {c: [<span class="bu">str</span>(c) <span class="op">+</span> <span class="bu">str</span>(i) <span class="cf">for</span> i <span class="kw">in</span> ind]</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> c <span class="kw">in</span> cols}</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> pd.DataFrame(data, ind)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Examples: Visualizing df operations</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="op">=</span> make_df(<span class="st">&#39;AB&#39;</span>, [<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> make_df(<span class="st">&#39;AB&#39;</span>, [<span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;df1&#39;</span>, <span class="st">&#39;df2&#39;</span>, <span class="st">&#39;pd.concat([df1, df2])&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Examples: Visualizing matrix operations</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix algebra &amp; operations</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;X&#39;</span>, <span class="st">&#39;Y.T&#39;</span>, <span class="st">&#39;X @ Y.T&#39;</span>, <span class="st">&#39;la.inv(X @ Y.T)&#39;</span>, <span class="st">&#39;la.det(X @ Y.T)&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Outer products</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;y&#39;</span>, <span class="st">&#39;np.outer(x, y)&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eigendecomposition</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>X_square <span class="op">=</span> np.vstack((X, np.array([<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>eig, Evec <span class="op">=</span> la.eig(X_square)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>Eig <span class="op">=</span> np.diag(eig)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;X_square&#39;</span>, <span class="st">&#39;Eig&#39;</span>, <span class="st">&#39;Evec&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix decomposition</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>U, d, V_T <span class="op">=</span> la.svd(X_square)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> np.diag(d)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;X_square&#39;</span>, <span class="st">&#39;U&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;V_T&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forming tensors: From vectors</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>x_vec <span class="op">=</span> x[:, np.newaxis]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>x_ten <span class="op">=</span> x_vec[:, :, np.newaxis]</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;x&#39;</span>, <span class="st">&#39;x_vec&#39;</span>, <span class="st">&#39;x_ten&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forming tensors: From matrices</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>X_3D1 <span class="op">=</span> X[:, :, np.newaxis]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>X_3D2 <span class="op">=</span> X[:, np.newaxis, :]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>X_3D3 <span class="op">=</span> X[np.newaxis, :, :]</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;X&#39;</span>, <span class="st">&#39;X_3D1&#39;</span>, <span class="st">&#39;X_3D2&#39;</span>, <span class="st">&#39;X_3D3&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tensor broadcasting: From vectors</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;x_vec&#39;</span>, <span class="st">&#39;x_ten&#39;</span>,  <span class="st">&#39;c&#39;</span>, <span class="st">&#39;x_ten - c&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tensor broadcasting: From matrices</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;X&#39;</span>, <span class="st">&#39;X_3D1&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;X_3D1 - c&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshaping &amp; aggregating: From vectors</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;x_vec&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;x_ten - c&#39;</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;(x_ten - c) ** 2&#39;</span>,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;np.sum((x_ten - c) ** 2, axis=1)&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshaping &amp; aggregating: From tensors</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] add tensor dot product for summation over arbitrary dims</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;X&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;X_3D1 - c&#39;</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;(X_3D1 - c) ** 2&#39;</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;((X_3D1 - c) ** 2).reshape(len(X), 1, -1)&#39;</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;np.sum(((X_3D1 - c) ** 2).reshape(len(X), 1, -1), axis=1)&#39;</span>) <span class="co"># EATS empty 1st dim</span></span></code></pre></div>
</div>
<div id="tools-for-matrix-visualization" class="section level1"
number="4">
<h1><span class="header-section-number">4</span> Tools for matrix
visualization</h1>
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">### [def] Tools for visualizing LA operations</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.linalg <span class="im">as</span> la</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.patches <span class="im">import</span> Polygon</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">NOTE</span><span class="co">] attempted to resolve pyplot matrix rendering issues</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># !pip install array_to_latex</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># import array_to_latex as a2l</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;text.usetex&#39;] = True</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co"># mpl.rcParams[&#39;text.latex.preamble&#39;] = r&#39;\usepackage{{amsmath}}&#39;</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.rcParams[&quot;text.latex.preamble&quot;].join([</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">#         r&quot;\usepackage{dashbox}&quot;,</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="co">#         r&quot;\setmainfont{xcolor}&quot;])</span></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.rcParams.update({&quot;text.usetex&quot;: True})</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="co"># # [REF] https://inakleinbottle.com/posts/formatting-matrices-with-python/</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_matrix(matrix, environment<span class="op">=</span><span class="st">&quot;pmatrix&quot;</span>, formatter<span class="op">=</span><span class="bu">str</span>):</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">&quot;&quot;&quot;Format a matrix using LaTeX syntax&quot;&quot;&quot;</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> <span class="bu">isinstance</span>(matrix, np.ndarray):</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>            matrix <span class="op">=</span> np.array(matrix)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">Exception</span>:</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">raise</span> <span class="pp">TypeError</span>(<span class="st">&quot;Could not convert to Numpy array&quot;</span>)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(shape :<span class="op">=</span> matrix.shape) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>        matrix <span class="op">=</span> matrix.reshape(<span class="dv">1</span>, shape[<span class="dv">0</span>])</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">len</span>(shape) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">&quot;Array must be 2 dimensional&quot;</span>)</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>    body_lines <span class="op">=</span> [<span class="st">&quot; &amp; &quot;</span>.join(<span class="bu">map</span>(formatter, row)) <span class="cf">for</span> row <span class="kw">in</span> matrix]</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a>    body <span class="op">=</span> <span class="st">&quot;</span><span class="ch">\\\\\n</span><span class="st">&quot;</span>.join(body_lines)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f&quot;&quot;&quot;</span><span class="ch">\\</span><span class="ss">begin</span><span class="ch">{{</span><span class="sc">{</span>environment<span class="sc">}</span><span class="ch">}}</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="sc">{</span>body<span class="sc">}</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="ch">\\</span><span class="ss">end</span><span class="ch">{{</span><span class="sc">{</span>environment<span class="sc">}</span><span class="ch">}}</span><span class="ss">&quot;&quot;&quot;</span></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="co"># [REF] Geron</span></span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_vector2d(vector2d, origin<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">0</span>], <span class="op">**</span>options):</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> plt.arrow(origin[<span class="dv">0</span>], origin[<span class="dv">1</span>], vector2d[<span class="dv">0</span>], vector2d[<span class="dv">1</span>],</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a>                     linewidth<span class="op">=</span><span class="dv">1</span>, head_width<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a>                     head_length<span class="op">=</span><span class="fl">0.15</span>, length_includes_head<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a>                     <span class="op">**</span>options)</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-46"><a href="#cb39-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_transformation(P_before, P_after, text_before, text_after,</span>
<span id="cb39-47"><a href="#cb39-47" aria-hidden="true" tabindex="-1"></a>                        axis<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">4</span>], arrows<span class="op">=</span><span class="va">False</span>, display_mapping<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb39-48"><a href="#cb39-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> arrows:</span>
<span id="cb39-49"><a href="#cb39-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> vector_before, vector_after <span class="kw">in</span> <span class="bu">zip</span>(P_before.T, P_after.T):</span>
<span id="cb39-50"><a href="#cb39-50" aria-hidden="true" tabindex="-1"></a>            plot_vector2d(vector_before, color<span class="op">=</span><span class="st">&quot;blue&quot;</span>, linestyle<span class="op">=</span><span class="st">&quot;--&quot;</span>)</span>
<span id="cb39-51"><a href="#cb39-51" aria-hidden="true" tabindex="-1"></a>            <span class="co"># plot_vector2d(vector_before, color=&quot;blue&quot;, linestyle=&quot;-&quot;)</span></span>
<span id="cb39-52"><a href="#cb39-52" aria-hidden="true" tabindex="-1"></a>            plot_vector2d(vector_after, color<span class="op">=</span><span class="st">&quot;red&quot;</span>, linestyle<span class="op">=</span><span class="st">&quot;-&quot;</span>)</span>
<span id="cb39-53"><a href="#cb39-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-54"><a href="#cb39-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> display_mapping <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb39-55"><a href="#cb39-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># M_before = r&#39;$\begin{bmatrix} &#39; + &#39;\\&#39;.join([&#39; &amp; &#39;.join(map(str, row)) for row in P_before]) + &#39;\end{bmatrix}$&#39;</span></span>
<span id="cb39-56"><a href="#cb39-56" aria-hidden="true" tabindex="-1"></a>      plt.text(axis[<span class="dv">1</span>]<span class="op">*</span><span class="fl">.7</span>, axis[<span class="dv">3</span>]<span class="op">*</span><span class="fl">.7</span>,</span>
<span id="cb39-57"><a href="#cb39-57" aria-hidden="true" tabindex="-1"></a>               <span class="ss">f&quot;</span><span class="sc">{</span>format_matrix(P, environment<span class="op">=</span><span class="st">&#39;bmatrix&#39;</span>)<span class="sc">}</span><span class="ss">&quot;</span>,</span>
<span id="cb39-58"><a href="#cb39-58" aria-hidden="true" tabindex="-1"></a>               bbox<span class="op">=</span><span class="bu">dict</span>(facecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;white&#39;</span>, boxstyle<span class="op">=</span><span class="st">&#39;round,pad=0.3&#39;</span>),</span>
<span id="cb39-59"><a href="#cb39-59" aria-hidden="true" tabindex="-1"></a>               fontsize<span class="op">=</span><span class="dv">9</span>, color<span class="op">=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb39-60"><a href="#cb39-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-61"><a href="#cb39-61" aria-hidden="true" tabindex="-1"></a>    plt.gca().add_artist(Polygon(P_before.T, alpha<span class="op">=</span><span class="fl">0.2</span>))</span>
<span id="cb39-62"><a href="#cb39-62" aria-hidden="true" tabindex="-1"></a>    plt.gca().add_artist(Polygon(P_after.T, alpha<span class="op">=</span><span class="fl">0.3</span>, color<span class="op">=</span><span class="st">&quot;r&quot;</span>))</span>
<span id="cb39-63"><a href="#cb39-63" aria-hidden="true" tabindex="-1"></a>    plt.plot(P_before[<span class="dv">0</span>], P_before[<span class="dv">1</span>], <span class="st">&quot;b--&quot;</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb39-64"><a href="#cb39-64" aria-hidden="true" tabindex="-1"></a>    plt.plot(P_after[<span class="dv">0</span>], P_after[<span class="dv">1</span>], <span class="st">&quot;r--&quot;</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb39-65"><a href="#cb39-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-66"><a href="#cb39-66" aria-hidden="true" tabindex="-1"></a>    plt.text(P_before[<span class="dv">0</span>].mean(), P_before[<span class="dv">1</span>].mean(), text_before,</span>
<span id="cb39-67"><a href="#cb39-67" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb39-68"><a href="#cb39-68" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.text(P_before[0].max()*.9, P_before[1].max()*.9, text_before,</span></span>
<span id="cb39-69"><a href="#cb39-69" aria-hidden="true" tabindex="-1"></a>    <span class="co">#          fontsize=12, color=&quot;blue&quot;)</span></span>
<span id="cb39-70"><a href="#cb39-70" aria-hidden="true" tabindex="-1"></a>    plt.text(P_after[<span class="dv">0</span>].mean(), P_after[<span class="dv">1</span>].mean(), text_after,</span>
<span id="cb39-71"><a href="#cb39-71" aria-hidden="true" tabindex="-1"></a>             fontsize<span class="op">=</span><span class="dv">12</span>, color<span class="op">=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb39-72"><a href="#cb39-72" aria-hidden="true" tabindex="-1"></a>    plt.axis(axis)</span>
<span id="cb39-73"><a href="#cb39-73" aria-hidden="true" tabindex="-1"></a>    plt.gca().set_aspect(<span class="st">&quot;equal&quot;</span>)</span>
<span id="cb39-74"><a href="#cb39-74" aria-hidden="true" tabindex="-1"></a>    plt.grid()</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Examples: Vectors</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">5</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">1</span>])</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>plt.subplots(figsize<span class="op">=</span>(<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>plot_vector2d(u, color<span class="op">=</span><span class="st">&quot;r&quot;</span>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>plot_vector2d(v, color<span class="op">=</span><span class="st">&quot;b&quot;</span>)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>plot_vector2d(v, origin<span class="op">=</span>u, color<span class="op">=</span><span class="st">&quot;b&quot;</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>plot_vector2d(u, origin<span class="op">=</span>v, color<span class="op">=</span><span class="st">&quot;r&quot;</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>plot_vector2d(u<span class="op">+</span>v, color<span class="op">=</span><span class="st">&quot;g&quot;</span>)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>plt.axis([<span class="dv">0</span>, <span class="fl">6.5</span>, <span class="dv">0</span>, <span class="fl">6.5</span>])</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>plt.gca().set_aspect(<span class="st">&quot;equal&quot;</span>)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">0.7</span>, <span class="dv">3</span>, <span class="st">&quot;u&quot;</span>, color<span class="op">=</span><span class="st">&quot;r&quot;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">4</span>, <span class="dv">3</span>, <span class="st">&quot;u&quot;</span>, color<span class="op">=</span><span class="st">&quot;r&quot;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">1.8</span>, <span class="fl">0.2</span>, <span class="st">&quot;v&quot;</span>, color<span class="op">=</span><span class="st">&quot;b&quot;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">3.1</span>, <span class="fl">5.6</span>, <span class="st">&quot;v&quot;</span>, color<span class="op">=</span><span class="st">&quot;b&quot;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="fl">2.4</span>, <span class="fl">2.5</span>, <span class="st">&quot;u+v&quot;</span>, color<span class="op">=</span><span class="st">&quot;g&quot;</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Examples: Matrices</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [def] Helper to get min &amp; max coordinates of start &amp; end matrices</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> mat_minmax_coords(<span class="op">*</span>matrices, square<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  stacked_matrix <span class="op">=</span> np.hstack(matrices)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  xy_min <span class="op">=</span> np.<span class="bu">min</span>(stacked_matrix, axis<span class="op">=</span><span class="dv">1</span>) <span class="op">*</span> <span class="fl">1.1</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  xy_max <span class="op">=</span> np.<span class="bu">max</span>(stacked_matrix, axis<span class="op">=</span><span class="dv">1</span>) <span class="op">*</span> <span class="fl">1.1</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  axis <span class="op">=</span> [xy_min[<span class="dv">0</span>], xy_max[<span class="dv">0</span>], xy_min[<span class="dv">1</span>], xy_max[<span class="dv">1</span>]]</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> square:</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>    axis_lengths <span class="op">=</span> [xy_max[<span class="dv">0</span>] <span class="op">-</span> xy_min[<span class="dv">0</span>], xy_max[<span class="dv">1</span>] <span class="op">-</span> xy_min[<span class="dv">1</span>]]</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    scale_factor <span class="op">=</span> <span class="bu">max</span>(axis_lengths)<span class="op">/</span>axis_lengths</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>    axis <span class="op">=</span> axis <span class="op">*</span> np.repeat(scale_factor, <span class="dv">2</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> axis</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Starting matrix</span></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># P = np.array([[3.0, 4.0, 1.0, 4.6], [0.2, 3.5, 2.0, 0.5]]) # non-convex shape</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co"># P = np.array([[0.0, 4.0, 6.0, 2.0], [0.0, 0.0, 5.0, 5.0]]) # neater shape</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> np.array([[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>]]) <span class="co"># square</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> P <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">8</span>))</span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="#cb41-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale</span></span>
<span id="cb41-24"><a href="#cb41-24" aria-hidden="true" tabindex="-1"></a>P_rescaled <span class="op">=</span> <span class="fl">.6</span> <span class="op">*</span> P</span>
<span id="cb41-25"><a href="#cb41-25" aria-hidden="true" tabindex="-1"></a>plt.sca(axs[<span class="dv">0</span>,<span class="dv">0</span>]) <span class="co"># [0, 3.5, 0, 3.5]</span></span>
<span id="cb41-26"><a href="#cb41-26" aria-hidden="true" tabindex="-1"></a>plot_transformation(P, P_rescaled, <span class="st">&quot;$P$&quot;</span>, <span class="st">&quot;$0.6 P$&quot;</span>,</span>
<span id="cb41-27"><a href="#cb41-27" aria-hidden="true" tabindex="-1"></a>                    axis<span class="op">=</span>mat_minmax_coords(P, P_rescaled, square<span class="op">=</span><span class="dv">0</span>),</span>
<span id="cb41-28"><a href="#cb41-28" aria-hidden="true" tabindex="-1"></a>                    arrows<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb41-29"><a href="#cb41-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Rotate</span></span>
<span id="cb41-31"><a href="#cb41-31" aria-hidden="true" tabindex="-1"></a>angle30 <span class="op">=</span> <span class="dv">30</span> <span class="op">*</span> np.pi <span class="op">/</span> <span class="dv">180</span> <span class="co"># angle in radians</span></span>
<span id="cb41-32"><a href="#cb41-32" aria-hidden="true" tabindex="-1"></a>angle120 <span class="op">=</span> <span class="dv">120</span> <span class="op">*</span> np.pi <span class="op">/</span> <span class="dv">180</span> <span class="co"># angle in radians</span></span>
<span id="cb41-33"><a href="#cb41-33" aria-hidden="true" tabindex="-1"></a>V <span class="op">=</span> np.array([</span>
<span id="cb41-34"><a href="#cb41-34" aria-hidden="true" tabindex="-1"></a>        [np.cos(angle30), np.sin(angle30)],</span>
<span id="cb41-35"><a href="#cb41-35" aria-hidden="true" tabindex="-1"></a>        [np.cos(angle120), np.sin(angle120)]])</span>
<span id="cb41-36"><a href="#cb41-36" aria-hidden="true" tabindex="-1"></a>P_rotated <span class="op">=</span> V <span class="op">@</span> P</span>
<span id="cb41-37"><a href="#cb41-37" aria-hidden="true" tabindex="-1"></a>plt.sca(axs[<span class="dv">0</span>,<span class="dv">1</span>]) <span class="co"># [-1.5, 4, -1.5, 4]</span></span>
<span id="cb41-38"><a href="#cb41-38" aria-hidden="true" tabindex="-1"></a>plot_transformation(P, P_rotated, <span class="st">&quot;$P$&quot;</span>, <span class="st">&quot;$V_</span><span class="sc">{rotate}</span><span class="st"> P$&quot;</span>,</span>
<span id="cb41-39"><a href="#cb41-39" aria-hidden="true" tabindex="-1"></a>                    axis<span class="op">=</span>mat_minmax_coords(P, P_rotated, square<span class="op">=</span><span class="dv">0</span>),</span>
<span id="cb41-40"><a href="#cb41-40" aria-hidden="true" tabindex="-1"></a>                    display_mapping<span class="op">=</span>V)</span>
<span id="cb41-41"><a href="#cb41-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-42"><a href="#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Shear</span></span>
<span id="cb41-43"><a href="#cb41-43" aria-hidden="true" tabindex="-1"></a>F_shear <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="fl">1.5</span>], [<span class="dv">0</span>, <span class="dv">1</span>]])</span>
<span id="cb41-44"><a href="#cb41-44" aria-hidden="true" tabindex="-1"></a>P_sheared <span class="op">=</span> F_shear <span class="op">@</span> P</span>
<span id="cb41-45"><a href="#cb41-45" aria-hidden="true" tabindex="-1"></a>plt.sca(axs[<span class="dv">1</span>,<span class="dv">0</span>]) <span class="co"># [0, 7, 0, 7]</span></span>
<span id="cb41-46"><a href="#cb41-46" aria-hidden="true" tabindex="-1"></a>plot_transformation(P, P_sheared, <span class="st">&quot;$P$&quot;</span>, <span class="st">&quot;$F_</span><span class="sc">{shear}</span><span class="st"> P$&quot;</span>,</span>
<span id="cb41-47"><a href="#cb41-47" aria-hidden="true" tabindex="-1"></a>                    axis<span class="op">=</span>mat_minmax_coords(P, P_sheared, square<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb41-48"><a href="#cb41-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-49"><a href="#cb41-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Horizontal reflection</span></span>
<span id="cb41-50"><a href="#cb41-50" aria-hidden="true" tabindex="-1"></a>F_reflect <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>], [<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>]])</span>
<span id="cb41-51"><a href="#cb41-51" aria-hidden="true" tabindex="-1"></a>P_reflected <span class="op">=</span> F_reflect <span class="op">@</span> P</span>
<span id="cb41-52"><a href="#cb41-52" aria-hidden="true" tabindex="-1"></a>plt.sca(axs[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="co"># [-3, 4, -3, 4]</span></span>
<span id="cb41-53"><a href="#cb41-53" aria-hidden="true" tabindex="-1"></a>plot_transformation(P, P_reflected, <span class="st">&quot;$P$&quot;</span>, <span class="st">&quot;$F_</span><span class="sc">{reflect}</span><span class="st"> P$&quot;</span>,</span>
<span id="cb41-54"><a href="#cb41-54" aria-hidden="true" tabindex="-1"></a>                    axis<span class="op">=</span>mat_minmax_coords(P, P_reflected, square<span class="op">=</span><span class="dv">0</span>))</span>
<span id="cb41-55"><a href="#cb41-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-56"><a href="#cb41-56" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Example: SVD</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co"># M = np.array([[1, 1.5], [0, 1]]) # F_shear</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> (np.array([[<span class="dv">1</span>, <span class="fl">1.5</span>], [<span class="dv">0</span>, <span class="dv">1</span>]]))<span class="op">*-</span><span class="dv">1</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>Square <span class="op">=</span> np.array([</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>U, d, V_T <span class="op">=</span> la.svd(M) <span class="co"># 𝜎/Σ_diag, Σ</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> np.diag(d)</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> np.<span class="bu">any</span>(np.<span class="bu">round</span>(U <span class="op">@</span> D <span class="op">@</span> V_T, <span class="dv">1</span>) <span class="op">==</span> np.<span class="bu">round</span>(M, <span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SVD</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">6</span>))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>axis <span class="op">=</span> mat_minmax_coords(</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    Square, V_T <span class="op">@</span> Square, D <span class="op">@</span> V_T <span class="op">@</span> Square, U <span class="op">@</span> D <span class="op">@</span> V_T <span class="op">@</span> Square, square<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>plt.sca(axs[<span class="dv">0</span>]) <span class="co"># no need to explicitly plot with axs handle for custom plotter</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>plot_transformation(Square, V_T <span class="op">@</span> Square, <span class="st">&quot;$Square$&quot;</span>, <span class="vs">r&quot;$V^T \cdot Square$&quot;</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                    axis<span class="op">=</span>axis)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;$(V^T) \cdot Square$&#39;</span>)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>plt.sca(axs[<span class="dv">1</span>])</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>plot_transformation(V_T <span class="op">@</span> Square, D <span class="op">@</span> V_T <span class="op">@</span> Square,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>                    <span class="vs">r&quot;$V^T \cdot Square$&quot;</span>, <span class="vs">r&quot;$\Sigma \cdot V^T \cdot Square$&quot;</span>,</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>                    axis<span class="op">=</span>axis)</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;$(\Sigma \cdot V^T) \cdot Square$&#39;</span>)</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>plt.sca(axs[<span class="dv">2</span>])</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>plot_transformation(D <span class="op">@</span> V_T <span class="op">@</span> Square, U <span class="op">@</span> D <span class="op">@</span> V_T <span class="op">@</span> Square,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>                    <span class="vs">r&quot;$\Sigma \cdot V^T \cdot Square$&quot;</span>,</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>                    <span class="vs">r&quot;$U \cdot \Sigma \cdot V^T \cdot Square$&quot;</span>,</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>                    axis<span class="op">=</span>axis)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;$(U \cdot \Sigma \cdot V^T) \cdot Square$&#39;</span>)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.suptitle(&#39;SVD&#39;)</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="preliminary-tests" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Preliminary tests</h1>
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">### [def] Generate B/W image</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">19680801</span>) <span class="co"># seed random number generator</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_stripe_image(size, stripe_nr, vertical <span class="op">=</span> <span class="va">True</span>):</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">&quot;&quot;&quot;Generate random (black) square image w/ `stripe_nr` (white) stripes&quot;&quot;&quot;</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  img <span class="op">=</span> np.zeros((size, size, <span class="dv">1</span>), dtype <span class="op">=</span> <span class="st">&quot;uint8&quot;</span>) <span class="co"># init size^2 img of 0&#39;s</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, stripe_nr):</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>      x, y <span class="op">=</span> np.random.randint(<span class="dv">0</span>, size, <span class="dv">2</span>) <span class="co"># gen 2 rand int btwn 0 &amp; size</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>      l <span class="op">=</span> np.<span class="bu">int</span>(np.random.randint(y, size, <span class="dv">1</span>)) <span class="co"># rand int btwn y &amp; size</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (vertical): <span class="co"># set to True by default</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>          img[y:l, x, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">255</span> <span class="co"># add vertical line from y:l in rand col x</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>:</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>          img[x, y:l, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">255</span> <span class="co"># horizontal line in row x</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> img</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">### [fig] Example: Plot image</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example image for reference</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>img <span class="op">=</span> generate_stripe_image(<span class="dv">50</span>, <span class="dv">10</span>, vertical <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(img[:, :, <span class="dv">0</span>], cmap <span class="op">=</span> <span class="st">&#39;gray&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Generate training and validation sets</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>n_img <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># n_stripes = 10</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># img_size = 50</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize empty arrays to store training/validation sets</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> X_val <span class="op">=</span> np.empty([n_img, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">1</span>])</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>vert <span class="op">=</span> <span class="va">True</span> <span class="co"># initially generate vertical images</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>n_vert <span class="op">=</span> <span class="fl">.5</span><span class="op">*</span>n_img</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co">## generate images</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(np.shape(X_train)[<span class="dv">0</span>]):</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># start generating horizontal images half-way through loop</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">==</span> n_vert <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>      vert <span class="op">=</span> <span class="va">False</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    X_train[i, :, :, :] <span class="op">=</span> generate_stripe_image(<span class="dv">50</span>, <span class="dv">10</span>, vert)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    X_val[i, :, :, :] <span class="op">=</span> generate_stripe_image(<span class="dv">50</span>, <span class="dv">10</span>, vert)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a><span class="co">## (standard) normalize training and validation sets (based on training data)</span></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>X_mean <span class="op">=</span> np.mean(X_train, axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>X_std <span class="op">=</span> np.std(X_train, axis <span class="op">=</span> <span class="dv">0</span>) <span class="op">+</span> <span class="fl">1e-7</span> <span class="co"># to deal w/ potential sd&#39;s of 0</span></span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> (X_train <span class="op">-</span> X_mean) <span class="op">/</span> X_std</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>X_val <span class="op">=</span> (X_val <span class="op">-</span> X_mean) <span class="op">/</span> X_std</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Store true class labels (0 = vert. stripes; 1 = horiz.)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>Y_train <span class="op">=</span> np.zeros(<span class="dv">500</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>Y_train <span class="op">=</span> Y_val <span class="op">=</span> np.append(Y_train, np.ones(<span class="dv">500</span>))</span></code></pre></div>
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Basics</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], label<span class="op">=</span><span class="st">&#39;Example line 1&#39;</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], label<span class="op">=</span><span class="st">&#39;Example line 2&#39;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>ax.scatter([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>ax.scatter([<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>ax.grid()<span class="op">;</span> ax.legend()</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(<span class="fl">.75</span>,<span class="fl">3.25</span>)<span class="op">;</span> <span class="co">#ax.set_ylim(0,3)</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>ax.set_xticks([<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>,<span class="fl">2.5</span>,<span class="dv">3</span>])<span class="op">;</span> <span class="co">#ax.set_yticks([1,2,3])</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;$x$&#39;</span>)<span class="op">;</span> ax.set_ylabel(<span class="st">&#39;$y$&#39;</span>)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Lines &amp; scatter&#39;</span>)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] compute bar heights from randomly generated averages &amp; add error bar</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fig, ax = plt.subplots(figsize=(6/1.2,4*1.2))</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(layout<span class="op">=</span><span class="st">&#39;constrained&#39;</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>ax.bar([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], label<span class="op">=</span><span class="st">&#39;Example bar 1&#39;</span>, width<span class="op">=</span><span class="fl">.3</span>, alpha<span class="op">=</span><span class="fl">.85</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>ax.bar([<span class="fl">1.5</span>, <span class="fl">2.5</span>], [<span class="dv">4</span>, <span class="dv">6</span>], label<span class="op">=</span><span class="st">&#39;Example bar 2&#39;</span>, width<span class="op">=</span><span class="fl">.3</span>, alpha<span class="op">=</span><span class="fl">.85</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>ax.grid(which<span class="op">=</span><span class="st">&#39;major&#39;</span>, axis<span class="op">=</span><span class="st">&#39;y&#39;</span>)<span class="op">;</span> ax.legend()</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>ax.set_xticks([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;$x$&#39;</span>)<span class="op">;</span> ax.set_ylabel(<span class="st">&#39;$y$&#39;</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Bars&#39;</span>)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Pivot table for numeric column aggregated wrt 2 cats (group/level)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] move to data exploration, above grouping/joins</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the tips dataset</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> sns.load_dataset(<span class="st">&quot;tips&quot;</span>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the categorical variables for levels and groups</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>level_variable <span class="op">=</span> <span class="st">&quot;sex&quot;</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>group_variable <span class="op">=</span> <span class="st">&quot;day&quot;</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a pivot table to structure the data</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>pivot_table <span class="op">=</span> tips.pivot_table(values<span class="op">=</span><span class="st">&quot;total_bill&quot;</span>, index<span class="op">=</span>level_variable, columns<span class="op">=</span>group_variable, aggfunc<span class="op">=</span><span class="st">&quot;mean&quot;</span>)</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>pivot_table</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Pivot table for num column w/ non-aggregated values wrt 2 cats (group/level)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For quickly plotting group comparisons</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] move to data exploration, above grouping/joins</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the tips dataset</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> sns.load_dataset(<span class="st">&quot;tips&quot;</span>)</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the categorical variables for levels and groups</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>level_variable <span class="op">=</span> <span class="st">&quot;sex&quot;</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>group_variable <span class="op">=</span> <span class="st">&quot;day&quot;</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by the specified variables and collect total_bill values as arrays</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> tips.groupby([level_variable, group_variable])[<span class="st">&quot;total_bill&quot;</span>].<span class="bu">apply</span>(<span class="bu">list</span>).unstack()</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the resulting DataFrame</span></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>grouped_data</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Stat + CI for num column w/ non-aggregated values wrt 2 cats (group/level)</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># For quickly obtaining stats and err for group comparisons</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] move to data exploration, above grouping/joins</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Assume grouped_data is a DataFrame with multi-index (group, level) and values as arrays</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace &#39;total_bill&#39; with the actual column name containing arrays</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>grouped_data <span class="op">=</span> tips.groupby([<span class="st">&#39;sex&#39;</span>, <span class="st">&#39;day&#39;</span>])[<span class="st">&#39;total_bill&#39;</span>].<span class="bu">apply</span>(np.array)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate mean and confidence interval</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_mean_ci(data):</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert non-numeric values to NaN and drop them</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    numeric_data <span class="op">=</span> pd.Series(data).<span class="bu">apply</span>(pd.to_numeric, errors<span class="op">=</span><span class="st">&#39;coerce&#39;</span>).dropna()</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(numeric_data) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>        mean <span class="op">=</span> np.mean(numeric_data)</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>        ci <span class="op">=</span> stats.t.interval(<span class="fl">0.95</span>, <span class="bu">len</span>(numeric_data) <span class="op">-</span> <span class="dv">1</span>, loc<span class="op">=</span>np.mean(numeric_data), scale<span class="op">=</span>stats.sem(numeric_data))</span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> mean, ci</span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan, (np.nan, np.nan)</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to each group</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>result_list <span class="op">=</span> []</span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (group, level), data <span class="kw">in</span> grouped_data.items():</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>    mean, ci <span class="op">=</span> calculate_mean_ci(data)</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>    result_list.append({</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Group&#39;</span>: group,</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Level&#39;</span>: level,</span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Mean&#39;</span>: mean,</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Confidence Interval&#39;</span>: ci</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the list of means and confidence intervals</span></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> result <span class="kw">in</span> result_list:</span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(result)</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] add option to plot sigbars for within group comparisons instead of btwn</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] add option to plot sigbars for betwn group comps of particular level</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] check accuracy of stats</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] clean up</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> combinations</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the number of groups and bars per group</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>N_GROUPS <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>N_LEVELS <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate or use actual data for averages and confidence intervals</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">5</span>, scale<span class="op">=</span><span class="fl">1.0</span>, size<span class="op">=</span>(N_GROUPS, N_LEVELS, <span class="dv">10</span>))  <span class="co"># Adjusted the number of samples</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Modify a couple of bar values to demonstrate significant differences</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>data[<span class="dv">0</span>, <span class="dv">0</span>, :] <span class="op">+=</span> <span class="fl">2.5</span>  <span class="co"># Increase the first bar in the first group</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>data[<span class="dv">2</span>, <span class="dv">2</span>, :] <span class="op">-=</span> <span class="fl">2.5</span>  <span class="co"># Decrease the third bar in the third group</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate averages and confidence intervals</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>averages <span class="op">=</span> np.mean(data, axis<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>conf_intervals <span class="op">=</span> np.zeros_like(averages, dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> group_idx <span class="kw">in</span> <span class="bu">range</span>(N_GROUPS):</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> level_idx <span class="kw">in</span> <span class="bu">range</span>(N_LEVELS):</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>        interval <span class="op">=</span> stats.t.interval(<span class="fl">0.95</span>, <span class="bu">len</span>(data[group_idx, level_idx]) <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>                                    loc<span class="op">=</span>np.mean(data[group_idx, level_idx]),</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>                                    scale<span class="op">=</span>stats.sem(data[group_idx, level_idx]))</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>        conf_intervals[group_idx, level_idx] <span class="op">=</span> np.<span class="bu">abs</span>(interval[<span class="dv">1</span>] <span class="op">-</span> averages[group_idx, level_idx])  <span class="co"># Use upper bound</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot grouped bars with confidence intervals</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.2</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> plt.cm.viridis(np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, N_LEVELS))</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>line_thickness <span class="op">=</span> <span class="fl">0.7</span>  <span class="co"># Adjust the line thickness</span></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>stagger_amount <span class="op">=</span> <span class="fl">0.8</span>  <span class="co"># Increased the stagger amount</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> level_idx <span class="kw">in</span> <span class="bu">range</span>(N_LEVELS):</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    bars <span class="op">=</span> ax.bar(np.arange(N_GROUPS) <span class="op">+</span> level_idx <span class="op">*</span> width <span class="op">-</span> (width <span class="op">*</span> (N_LEVELS <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span>),</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>                  averages[:, level_idx],</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>                  yerr<span class="op">=</span>conf_intervals[:, level_idx],</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>                  width<span class="op">=</span>width,</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>                  alpha<span class="op">=</span><span class="fl">0.85</span>,</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>                  capsize<span class="op">=</span><span class="dv">3</span>,</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>                  color<span class="op">=</span>colors[level_idx],</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>                  label<span class="op">=</span><span class="ss">f&#39;Level </span><span class="sc">{</span>level_idx <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">&#39;</span>,</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>                  error_kw<span class="op">=</span>{<span class="st">&#39;elinewidth&#39;</span>: line_thickness})  <span class="co"># Set the line thickness for error bars</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="co"># Set labels and title</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;Groups&#39;</span>)</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Values&#39;</span>)</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Grouped Bars with Confidence Intervals&#39;</span>)</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Set x-axis ticks and labels</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>group_labels <span class="op">=</span> [<span class="ss">f&#39;Group </span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">&#39;</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, N_GROUPS <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(np.arange(N_GROUPS))</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(group_labels)</span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>ax.legend(title<span class="op">=</span><span class="st">&#39;Levels&#39;</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>), loc<span class="op">=</span><span class="st">&#39;upper left&#39;</span>)</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Add staggered significance bars and asterisks for select between-group comparisons</span></span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>significance_level <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>stagger_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> comb <span class="kw">in</span> combinations(<span class="bu">range</span>(N_GROUPS), <span class="dv">2</span>):x</span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a>    group1_center <span class="op">=</span> ax.get_xticks()[comb[<span class="dv">0</span>]]</span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>    group2_center <span class="op">=</span> ax.get_xticks()[comb[<span class="dv">1</span>]]</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>    t_stat, p_value <span class="op">=</span> stats.ttest_ind(data[comb[<span class="dv">0</span>], :, :].flatten(), data[comb[<span class="dv">1</span>], :, :].flatten())</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> p_value <span class="op">&lt;</span> significance_level:</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>        tallest_bar_height <span class="op">=</span> np.<span class="bu">max</span>(averages) <span class="op">+</span> np.<span class="bu">max</span>(conf_intervals) <span class="op">+</span> <span class="fl">0.5</span></span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a>        significance_height <span class="op">=</span> tallest_bar_height <span class="op">+</span> np.<span class="bu">max</span>(conf_intervals) <span class="op">*</span> <span class="fl">0.07</span> <span class="op">+</span> stagger_index <span class="op">*</span> stagger_amount  <span class="co"># Adjust the stagger amount</span></span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot staggered horizontal lines aligned with the midpoints of the compared groups</span></span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a>        ax.plot([group1_center, group2_center],</span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a>                [significance_height] <span class="op">*</span> <span class="dv">2</span>, color<span class="op">=</span><span class="st">&#39;black&#39;</span>, lw<span class="op">=</span>line_thickness)</span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot asterisks aligned with the center of the significance bars</span></span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a>        asterisks <span class="op">=</span> <span class="st">&#39;*&#39;</span> <span class="op">*</span> <span class="bu">sum</span>([p_value <span class="op">&lt;</span> alpha <span class="cf">for</span> alpha <span class="kw">in</span> [<span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>]])</span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a>        ax.text((group1_center <span class="op">+</span> group2_center) <span class="op">/</span> <span class="dv">2</span>, significance_height,</span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a>                asterisks, ha<span class="op">=</span><span class="st">&#39;center&#39;</span>, va<span class="op">=</span><span class="st">&#39;bottom&#39;</span>, fontsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a>        stagger_index <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># Increment the index for staggered bars</span></span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Print significant comparisons, t-test results, and sample sizes</span></span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a>        sample_size1 <span class="op">=</span> <span class="bu">len</span>(data[comb[<span class="dv">0</span>], :, :].flatten())</span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a>        sample_size2 <span class="op">=</span> <span class="bu">len</span>(data[comb[<span class="dv">1</span>], :, :].flatten())</span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f&#39;Significant comparison between </span><span class="sc">{</span>group_labels[comb[<span class="dv">0</span>]]<span class="sc">}</span><span class="ss"> and </span><span class="sc">{</span>group_labels[comb[<span class="dv">1</span>]]<span class="sc">}</span><span class="ss">: &#39;</span></span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f&#39;p-value = </span><span class="sc">{</span>p_value<span class="sc">}</span><span class="ss">, </span><span class="ch">\n</span><span class="ss">t-statistic = </span><span class="sc">{</span>t_stat<span class="sc">}</span><span class="ss">, &#39;</span></span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a>              <span class="ss">f&#39;Sample Size: </span><span class="sc">{</span>group_labels[comb[<span class="dv">0</span>]]<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>sample_size1<span class="sc">}</span><span class="ss">, </span><span class="sc">{</span>group_labels[comb[<span class="dv">1</span>]]<span class="sc">}</span><span class="ss"> = </span><span class="sc">{</span>sample_size2<span class="sc">}</span><span class="ch">\n</span><span class="ss">&#39;</span>)</span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb54-99"><a href="#cb54-99" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas.plotting <span class="im">import</span> scatter_matrix</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> FormatStrFormatter</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> sns.load_dataset(<span class="st">&quot;iris&quot;</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>data_ <span class="op">=</span> data.rename(columns<span class="op">=</span><span class="kw">lambda</span> name: name.replace(<span class="st">&#39;_&#39;</span>, <span class="st">&#39; &#39;</span>).capitalize())</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots()</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>axs <span class="op">=</span> scatter_matrix(data_, ax<span class="op">=</span>axs, diagonal<span class="op">=</span><span class="st">&#39;hist&#39;</span>, alpha<span class="op">=</span><span class="fl">.75</span>,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                     hist_kwds<span class="op">=</span><span class="bu">dict</span>(alpha<span class="op">=</span><span class="fl">.75</span>),</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate through the axes to set the y-axis formatter</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax <span class="kw">in</span> axs.flatten():</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.yaxis.set_major_formatter(FormatStrFormatter(&#39;%05.2f&#39;))</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_formatter(FormatStrFormatter(<span class="st">&#39;</span><span class="sc">%.2f</span><span class="st">&#39;</span>))</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_formatter(FormatStrFormatter(<span class="st">&#39;</span><span class="sc">%.1f</span><span class="st">&#39;</span>))</span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>    ax.tick_params(axis<span class="op">=</span><span class="st">&#39;both&#39;</span>, labelsize<span class="op">=</span><span class="dv">7</span>)</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.label.set_size(<span class="dv">8</span>)</span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.label.set_size(<span class="dv">8</span>)</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.grid()</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">&quot;Scatter matrix&quot;</span>)</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] Add example where axes flipped so text horizontal with bars</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> (<span class="st">&quot;Adelie&quot;</span>, <span class="st">&quot;Chinstrap&quot;</span>, <span class="st">&quot;Gentoo&quot;</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>penguin_means <span class="op">=</span> {</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bill Depth&#39;</span>: (<span class="fl">18.35</span>, <span class="fl">18.43</span>, <span class="fl">14.98</span>),</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bill Length&#39;</span>: (<span class="fl">38.79</span>, <span class="fl">48.83</span>, <span class="fl">47.50</span>),</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Flipper Length&#39;</span>: (<span class="fl">189.95</span>, <span class="fl">195.82</span>, <span class="fl">217.19</span>),</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(species))  <span class="co"># the label locations</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># the width of the bars</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>spacing <span class="op">=</span> <span class="fl">0.009</span> <span class="co"># the space between bars within groups</span></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>multiplier <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.color_palette(<span class="st">&#39;viridis&#39;</span>, n_colors<span class="op">=</span><span class="dv">3</span>, as_cmap<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co"># color=ListedColormap(plt.cm.tab20b((np.arange(0,9))))</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  fig, ax <span class="op">=</span> plt.subplots(layout<span class="op">=</span><span class="st">&#39;constrained&#39;</span>)</span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> attribute, measurement <span class="kw">in</span> penguin_means.items():</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    offset <span class="op">=</span> (width <span class="op">+</span> spacing) <span class="op">*</span> multiplier</span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>    rects <span class="op">=</span> ax.bar(x <span class="op">+</span> offset, measurement, width, alpha<span class="op">=</span><span class="fl">.85</span>,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>attribute.lower().capitalize())</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    ax.bar_label(rects, padding<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>    multiplier <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>)<span class="op">;</span> ax.legend(ncols<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">250</span>)</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_xticks(x + width, species)</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(x <span class="op">+</span> ((width <span class="op">+</span> spacing) <span class="op">*</span> (multiplier <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span>), species)</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;Length (mm)&#39;</span>)</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Whitepaper plot&#39;</span>)</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> (<span class="st">&quot;Adelie&quot;</span>, <span class="st">&quot;Chinstrap&quot;</span>, <span class="st">&quot;Gentoo&quot;</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>penguin_means <span class="op">=</span> {</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bill Depth&#39;</span>: (<span class="fl">18.35</span>, <span class="fl">18.43</span>, <span class="fl">14.98</span>),</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Bill Length&#39;</span>: (<span class="fl">38.79</span>, <span class="fl">48.83</span>, <span class="fl">47.50</span>),</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;Flipper Length&#39;</span>: (<span class="fl">189.95</span>, <span class="fl">195.82</span>, <span class="fl">217.19</span>),</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="bu">len</span>(species))  <span class="co"># the label locations</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="fl">0.2</span>  <span class="co"># the width of the bars</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>spacing <span class="op">=</span> <span class="fl">0.0</span>  <span class="co"># the space between bars within groups</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>multiplier <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.color_palette(<span class="st">&#39;viridis&#39;</span>, n_colors<span class="op">=</span><span class="dv">3</span>, as_cmap<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    fig, ax <span class="op">=</span> plt.subplots(layout<span class="op">=</span><span class="st">&#39;constrained&#39;</span>, figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="fl">3.5</span>))</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> attribute, measurement <span class="kw">in</span> penguin_means.items():</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>        offset <span class="op">=</span> (width <span class="op">+</span> spacing) <span class="op">*</span> multiplier</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>        rects <span class="op">=</span> ax.barh(x <span class="op">+</span> offset, measurement, height<span class="op">=</span>width, alpha<span class="op">=</span><span class="fl">.85</span>,</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>                        label<span class="op">=</span>attribute.lower().capitalize())</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>        ax.bar_label(rects, padding<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>        multiplier <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    ax.grid(axis<span class="op">=</span><span class="st">&#39;x&#39;</span>)</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    ax.legend(ncols<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="dv">0</span>, <span class="dv">250</span>)</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks(x <span class="op">+</span> ((width <span class="op">+</span> spacing) <span class="op">*</span> (multiplier <span class="op">-</span> <span class="dv">1</span>) <span class="op">/</span> <span class="dv">2</span>))</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>    ax.set_yticklabels(species)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">&#39;Length (mm)&#39;</span>)</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>    ax.set_title(<span class="st">&#39;Transposed whitepaper plot&#39;</span>)</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="grid" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Grid</h1>
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># At least one dimension must be &gt; 1</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>N_ROWS <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>N_COLS <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data for each subplot in groups of 2</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span> np.pi, <span class="dv">100</span>)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>functions <span class="op">=</span> []</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>titles <span class="op">=</span> []</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N_ROWS<span class="op">*</span>N_COLS <span class="op">*</span> <span class="dv">2</span>):</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>  functions.append(<span class="kw">lambda</span> x: np.sin((i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> x))</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  functions.append(<span class="kw">lambda</span> x: np.cos((i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> x))</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span>): titles.append(<span class="ss">f&#39;$a = </span><span class="sc">{</span><span class="bu">int</span>(i<span class="op">/</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span>)<span class="sc">}</span><span class="ss">$&#39;</span>)</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 2x2 subplots grid using a for loop</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(N_ROWS, N_COLS, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Flatten the axs array for easier iteration</span></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>axs <span class="op">=</span> axs.flatten()</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through subplots and plot data</span></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, ax <span class="kw">in</span> <span class="bu">enumerate</span>(axs):</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>    y1 <span class="op">=</span> functions[i <span class="op">*</span> <span class="dv">2</span>](x)</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>    y2 <span class="op">=</span> functions[(i <span class="op">*</span> <span class="dv">2</span>) <span class="op">+</span> <span class="dv">1</span>](x)</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y1)</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y2)</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># To add legend to each frame</span></span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.legend(labels=[f&#39;$sin({i + 1}x)$&#39;, f&#39;$cos({i + 1}x)$&#39;], loc=2)</span></span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set title of each frame and label only rows and columns</span></span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>    ax.set_title(titles[i])</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="op">&gt;</span> (N_ROWS <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> N_COLS <span class="op">-</span> <span class="dv">1</span>): ax.set_xlabel(<span class="st">&#39;$x$&#39;</span>)</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> i <span class="op">%</span> N_COLS <span class="op">==</span> <span class="dv">0</span>: ax.set_ylabel(<span class="st">&#39;$y$&#39;</span>)</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>    ax.grid()</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend for groups</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>fig.legend(labels<span class="op">=</span>[<span class="st">&#39;$sin(ax)$&#39;</span>, <span class="st">&#39;$cos(ax)$&#39;</span>], bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">.89</span>), loc<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Use tight layout (default) to prevent clipping of titles &amp; center</span></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>fig.supylabel(<span class="st">&#39;$y$&#39;</span>)</span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>fig.supxlabel(<span class="st">&#39;$x$&#39;</span>, x<span class="op">=</span><span class="fl">.58</span>)</span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Subplot grid&#39;</span>, x<span class="op">=</span><span class="fl">.58</span>)</span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="seaborn-extensions-for-statistical-plotting"
class="section level1" number="7">
<h1><span class="header-section-number">7</span> Seaborn extensions for
statistical plotting</h1>
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> StrMethodFormatter</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> sns.load_dataset(<span class="st">&quot;iris&quot;</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>data_ <span class="op">=</span> data.rename(columns<span class="op">=</span><span class="kw">lambda</span> name: name.replace(<span class="st">&#39;_&#39;</span>, <span class="st">&#39; &#39;</span>).capitalize())</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>hist_kws    <span class="op">=</span> <span class="bu">dict</span>(edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>, linewidth<span class="op">=</span><span class="fl">.5</span>) <span class="co"># bins</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>kde_kws     <span class="op">=</span> <span class="bu">dict</span>(linewidth<span class="op">=</span><span class="fl">.5</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>scatter_kws <span class="op">=</span> <span class="bu">dict</span>(alpha<span class="op">=</span><span class="fl">.6</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>, linewidth<span class="op">=</span><span class="fl">.1</span>) <span class="co"># s</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>line_kws    <span class="op">=</span> <span class="bu">dict</span>(linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>reg_kws     <span class="op">=</span> <span class="bu">dict</span>(scatter_kws<span class="op">=</span>scatter_kws, line_kws<span class="op">=</span>line_kws)</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.axes_style(<span class="st">&#39;whitegrid&#39;</span>), sns.color_palette(<span class="st">&#39;viridis&#39;</span>):</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plt.figure(figsize=(6, 6))</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>  ax <span class="op">=</span> sns.pairplot(data_, <span class="bu">vars</span><span class="op">=</span>[<span class="st">&#39;Petal width&#39;</span>, <span class="st">&#39;Petal length&#39;</span>, <span class="st">&#39;Sepal length&#39;</span>],</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>                    hue<span class="op">=</span><span class="st">&#39;Species&#39;</span>,</span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>                    kind<span class="op">=</span><span class="st">&#39;reg&#39;</span>, diag_kind<span class="op">=</span><span class="st">&#39;kde&#39;</span>,</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>                    plot_kws<span class="op">=</span>reg_kws, diag_kws<span class="op">=</span>kde_kws,</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Grouped pairplot&#39;</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.axes.set_major_formatter(StrMethodFormatter(f&#39;{{x:.2f}}&#39;))</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.move_legend(ax, &quot;upper left&quot;, bbox_to_anchor=(1, .75))</span></span></code></pre></div>
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grouped boxplots</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] add sigstars to significant within-group differences</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> sns.load_dataset(<span class="st">&#39;tips&#39;</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># with sns.axes_style(&#39;whitegrid&#39;), sns.color_palette(&#39;viridis&#39;, n_colors=2):</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># with sns.color_palette(&#39;viridis&#39;, n_colors=2):</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.boxplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;day&#39;</span>, y<span class="op">=</span><span class="st">&#39;total_bill&#39;</span>, hue<span class="op">=</span><span class="st">&#39;sex&#39;</span>,</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>                <span class="co">#  dodge=1,</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>                 gap<span class="op">=</span><span class="fl">.2</span>, width<span class="op">=</span><span class="fl">.6</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>                 saturation<span class="op">=</span><span class="fl">.7</span>,</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>                 fliersize<span class="op">=</span><span class="fl">3.75</span>,</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>                <span class="co">#  whis=.5,</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>                <span class="co">#  linecolor=&#39;black&#39;, linewidth=.5,</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.legend(loc=&#39;center left&#39;, bbox_to_anchor=(1, 0.5))</span></span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>ax.grid(axis<span class="op">=</span><span class="st">&#39;y&#39;</span>)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>ax.legend(ncol<span class="op">=</span><span class="dv">2</span>, loc<span class="op">=</span><span class="st">&#39;best&#39;</span>)</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Category&#39;</span>)<span class="op">;</span> plt.ylabel(<span class="st">&#39;Value&#39;</span>)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Grouped boxplots&#39;</span>)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="op">=</span> sns.load_dataset(<span class="st">&quot;titanic&quot;</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.axes_style(<span class="st">&#39;whitegrid&#39;</span>):</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  plt.figure()</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  ax <span class="op">=</span> sns.FacetGrid(titanic, col<span class="op">=</span><span class="st">&quot;survived&quot;</span>, row<span class="op">=</span><span class="st">&quot;sex&quot;</span>)</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  ax <span class="op">=</span> ax.<span class="bu">map</span>(plt.hist, <span class="st">&quot;age&quot;</span>, alpha<span class="op">=</span><span class="fl">.85</span>, bins<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>ax.set_xlabels(<span class="st">&#39;Age&#39;</span>)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Bifaceted wildcard plot&#39;</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.tight_layout()</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="additional-seaborn-plots" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Additional seaborn
plots</h1>
<p>[TODO]</p>
<p>Missing 1. overlapping densities 2. overlapping scatter 3. jointplot
4. √ bars with error bar 5. timeseries w/ error bar</p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>tips <span class="op">=</span> sns.load_dataset(<span class="st">&#39;tips&#39;</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># hist_kws = dict(edgecolor=&#39;black&#39;, linewidth=.5) # bins</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>line_kws <span class="op">=</span> <span class="bu">dict</span>(linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>kde_kws  <span class="op">=</span> <span class="bu">dict</span>() <span class="co"># linewidth=.5</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.axes_style(<span class="st">&#39;whitegrid&#39;</span>):</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  plt.figure()</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  ax <span class="op">=</span> sns.histplot(data<span class="op">=</span>tips, x<span class="op">=</span><span class="st">&#39;total_bill&#39;</span>, <span class="co">#hue=&#39;sex&#39;,</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                    kde<span class="op">=</span><span class="va">True</span>, element<span class="op">=</span><span class="st">&#39;bars&#39;</span>, stat<span class="op">=</span><span class="st">&#39;count&#39;</span>,</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>                    line_kws<span class="op">=</span>line_kws, kde_kws<span class="op">=</span>kde_kws,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">10</span>, <span class="dv">60</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Value&#39;</span>)</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Histogram with KDE&#39;</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation matrix and heatmap</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] Make these colours nicer</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> sns.load_dataset(<span class="st">&#39;iris&#39;</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>iris_ <span class="op">=</span> iris.rename(columns<span class="op">=</span><span class="kw">lambda</span> name: name.replace(<span class="st">&#39;_&#39;</span>, <span class="st">&#39; &#39;</span>).capitalize())</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="op">=</span> iris_.corr(numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">#with sns.plotting_context(font_scale=.1):</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.heatmap(correlation_matrix,</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>                 annot<span class="op">=</span><span class="va">True</span>, cbar<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span>plt.cm.PiYG,</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>                 square<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>                 linewidths<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#linecolor=&#39;black&#39;, edgecolor=&#39;black&#39;,</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Heatmap&#39;</span>)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="math" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Math</h1>
<p>[TODO]</p>
<p>Missing 1. 3D scatter 2. 2D cartesian 3. 2<em>surface 4. curve 5.
2</em>2D vector field 6. 2D contour plot</p>
<p>ML plots: 7. [TODO] 3D data + PCs -&gt; transformed 2D 8. [TODO]
clean up generative (HoML), cluster/DR comparison</p>
<p>Functionalize: 12. [TODO] functionalize ML plots (args: fit model;
X/y train/test (test optional); DR/manifold method) 13. [TODO]
functionalize ML comparisons (args: model builds, labs, dataset lists;
DR/man meth; dataset kwargs)</p>
<p>[Multi] For class/clust functions: 14. [TODO] add support for
multi-class via appropriate custom colour generator calls 15. [TODO] add
support for multi-feature class/clust via appropriate DR/manifold method
(class DR, clust man)</p>
<p>[Prep] For class/clust/manifold functions: 16. [TODO] include
appropriate prep for each feature (num: scale, cat: enc, ts: smooth,
word: embed, sent: tfidf)</p>
<p>[Datasets] For ML comparison * class/clust functions: 17. [TODO]
include std set of datasets (blob/circ/lin) * std args (blob cov kw:
sphere/elip/ndiag, deg over, rand)</p>
<p>Later, for model-specific validations: - fix standard dataset &amp;
DR/manifold method &amp; prep</p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> sns.load_dataset(<span class="st">&#39;iris&#39;</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.axes_style(<span class="st">&#39;whitegrid&#39;</span>):</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  plt.figure()</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  sns.kdeplot(data<span class="op">=</span>iris, x<span class="op">=</span><span class="st">&#39;sepal_length&#39;</span>, y<span class="op">=</span><span class="st">&#39;sepal_width&#39;</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>              cmap<span class="op">=</span><span class="st">&#39;Blues&#39;</span>, fill<span class="op">=</span><span class="va">True</span>, levels<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Joint contour plot&#39;</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Feature 1&#39;</span>)<span class="op">;</span> plt.ylabel(<span class="st">&#39;Feature 2&#39;</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="analysis" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Analysis</h1>
<p>[TODO]</p>
<pre><code>def math_plotter(
  f: lambda {
    function(x, y), curve(t), surface(u, v), field(x, y, z)},
  type: string {
    &#39;2D&#39;, &#39;3D&#39;, &#39;contour&#39;, &#39;curve&#39;, &#39;surface&#39;, &#39;field&#39;},
  coordinates: string = &#39;rect&#39; {
    &#39;rect&#39;, &#39;radial&#39;, &#39;cylindrical&#39;, &#39;spherical&#39;},
  bounds: List(
    {x, t, u}: List(lo: float, hi: float) = [-10., 10.],
    {y, v}: List(lo: float, hi: float) = [-10., 10.],
    {z}: List(lo: float, hi: float) = [-10., 10.])
 ) -&gt; plot: mpl_object {
    f_plot: mpl_subplot,
    gradient_plot: mpl_subplot = None,
    integral_{plot, text} (explicit 2D graph if &#39;2D&#39; type given and closed form exists; else numerical estimate wrt some specified bounds):
    {mpl_subplot, string} = None}</code></pre>
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x, y):</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> np.sin(x) <span class="op">*</span> np.cos(y)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a grid of points &amp; corresponding smaller grid for a neater quiver plot</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, n), np.linspace(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, n))</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># X_quiv, Y_quiv = np.meshgrid(np.linspace(-5, 5, int(n/10)),</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co">#                              np.linspace(-5, 5, int(n/10)))</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the derivative of the surface</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> f(X, Y)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Z_quiv = f(X_quiv, Y_quiv)</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>dx, dy <span class="op">=</span> np.gradient(Z)</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># dx, dy = np.gradient(Z_quiv)</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the surface and its derivative</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">111</span>, projection<span class="op">=</span><span class="st">&#39;3d&#39;</span>)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(X, Y, Z, cmap<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>ax.quiver(X, Y, Z, dx, dy, np.zeros_like(dx),</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>          arrow_length_ratio<span class="op">=</span><span class="fl">.3</span>, color<span class="op">=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the axes labels</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;y&#39;</span>)</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">&#39;z&#39;</span>)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.integrate <span class="im">as</span> integrate</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate \int^\infty_0 e^{-x} dx</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># invexp = lambda x: np.exp(-x)</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="co"># integrate.quad(invexp, 0, np.inf)</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="co"># function = lambda x, y: x**2 + y**2</span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co"># integrate.quad(function, 0, np.inf)</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> integral(x, y):</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># return integrate.quad(lambda t: np.sqrt((x**2 + y**2 - 2*x*y*np.cos(np.pi*t*(np.sqrt(1/x**3) - np.sqrt(1/y**3))))/(x**3*y**3)), 0,  np.sqrt(x**3*y**3))[0]</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> integrate.quad(<span class="kw">lambda</span> t: t<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> t<span class="op">*</span>y<span class="op">**</span><span class="dv">2</span>, <span class="dv">0</span>, x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y<span class="op">**</span><span class="dv">2</span>)[<span class="dv">0</span>]</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="co"># X = np.arange(0.1, 5, 0.1)</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Y = np.arange(0.1, 5, 0.1)</span></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">.1</span>)</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> np.arange(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="fl">.1</span>)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(X, Y)</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> np.vectorize(integral)(X, Y)</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.axes(projection<span class="op">=</span><span class="st">&quot;3d&quot;</span>)</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>ax.plot_wireframe(X, Y, Z, color<span class="op">=</span><span class="st">&#39;green&#39;</span>)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;y&#39;</span>)</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">&#39;z&#39;</span>)</span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.axes(projection<span class="op">=</span><span class="st">&#39;3d&#39;</span>)</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a>ax.plot_surface(X, Y, Z, rstride<span class="op">=</span><span class="dv">1</span>, cstride<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>                norm<span class="op">=</span>plt.Normalize(np.nanmin(Z), np.nanmax(Z)),</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a>                cmap<span class="op">=</span><span class="st">&#39;winter&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;none&#39;</span>)</span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_xlim(-10, 10); ax.set_ylim(-10, 10); ax.set_zlim(-10, 10)</span></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="stats" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Stats</h1>
<p>[TODO] Plot common 2/3D dists alongside estimated: - mean/variance -
probability wrt some specified bounds</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> multivariate_normal</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>random_seed<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution params (3 covariance options, shared mean)</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>cov_val <span class="op">=</span> [<span class="op">-</span><span class="fl">0.8</span>, <span class="dv">0</span>, <span class="fl">0.8</span>]</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> np.array([<span class="dv">0</span>,<span class="dv">0</span>])</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Container for density functions for further analysis</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>pdf_list <span class="op">=</span> []</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot densities</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over different covariance values</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, val <span class="kw">in</span> <span class="bu">enumerate</span>(cov_val):</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the covariance matrix</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>    cov <span class="op">=</span> np.array([[<span class="dv">1</span>, val], [val, <span class="dv">1</span>]])</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate Gaussian bivariate dist with given mean and covariance matrix</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    distr <span class="op">=</span> multivariate_normal(cov <span class="op">=</span> cov, mean <span class="op">=</span> mean,</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>                                seed <span class="op">=</span> random_seed)</span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Generate a meshgrid complacent with the 3-sigma boundary</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>    mean_1, mean_2 <span class="op">=</span> mean[<span class="dv">0</span>], mean[<span class="dv">1</span>]</span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>    sigma_1, sigma_2 <span class="op">=</span> cov[<span class="dv">0</span>,<span class="dv">0</span>], cov[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb68-30"><a href="#cb68-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-31"><a href="#cb68-31" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span><span class="op">*</span>sigma_1, <span class="dv">3</span><span class="op">*</span>sigma_1, num<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb68-32"><a href="#cb68-32" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">3</span><span class="op">*</span>sigma_2, <span class="dv">3</span><span class="op">*</span>sigma_2, num<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb68-33"><a href="#cb68-33" aria-hidden="true" tabindex="-1"></a>    X, Y <span class="op">=</span> np.meshgrid(x,y)</span>
<span id="cb68-34"><a href="#cb68-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-35"><a href="#cb68-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Evaluate density for each point in the meshgrid</span></span>
<span id="cb68-36"><a href="#cb68-36" aria-hidden="true" tabindex="-1"></a>    pdf <span class="op">=</span> np.zeros(X.shape)</span>
<span id="cb68-37"><a href="#cb68-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">0</span>]):</span>
<span id="cb68-38"><a href="#cb68-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(X.shape[<span class="dv">1</span>]):</span>
<span id="cb68-39"><a href="#cb68-39" aria-hidden="true" tabindex="-1"></a>            pdf[i,j] <span class="op">=</span> distr.pdf([X[i,j], Y[i,j]])</span>
<span id="cb68-40"><a href="#cb68-40" aria-hidden="true" tabindex="-1"></a>    pdf_list.append(pdf)</span>
<span id="cb68-41"><a href="#cb68-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-42"><a href="#cb68-42" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot density function values</span></span>
<span id="cb68-43"><a href="#cb68-43" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">3</span>, idx <span class="op">+</span> <span class="dv">1</span>, projection <span class="op">=</span> <span class="st">&#39;3d&#39;</span>)</span>
<span id="cb68-44"><a href="#cb68-44" aria-hidden="true" tabindex="-1"></a>    ax.plot_surface(X, Y, pdf, cmap <span class="op">=</span> <span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb68-45"><a href="#cb68-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-46"><a href="#cb68-46" aria-hidden="true" tabindex="-1"></a>    ax.axes.zaxis.set_ticks([])</span>
<span id="cb68-47"><a href="#cb68-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.xlabel(&quot;$x_1$&quot;)</span></span>
<span id="cb68-48"><a href="#cb68-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.ylabel(&quot;$x_2$&quot;)</span></span>
<span id="cb68-49"><a href="#cb68-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.title(f&#39;Covariance between x1 and x2 = {val}&#39;)</span></span>
<span id="cb68-50"><a href="#cb68-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-51"><a href="#cb68-51" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb68-52"><a href="#cb68-52" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb68-53"><a href="#cb68-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-54"><a href="#cb68-54" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot contour maps</span></span>
<span id="cb68-55"><a href="#cb68-55" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>,<span class="dv">6</span>))</span>
<span id="cb68-56"><a href="#cb68-56" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> idx, val <span class="kw">in</span> <span class="bu">enumerate</span>(pdf_list):</span>
<span id="cb68-57"><a href="#cb68-57" aria-hidden="true" tabindex="-1"></a>    plt.subplot(<span class="dv">2</span>, <span class="dv">3</span>, idx <span class="op">+</span> <span class="dv">1</span>, aspect<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb68-58"><a href="#cb68-58" aria-hidden="true" tabindex="-1"></a>    plt.contourf(X, Y, val, cmap<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb68-59"><a href="#cb68-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-60"><a href="#cb68-60" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&quot;$x_1$&quot;</span>)</span>
<span id="cb68-61"><a href="#cb68-61" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&quot;$x_2$&quot;</span>)</span>
<span id="cb68-62"><a href="#cb68-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">#plt.title(f&#39;Covariance between x1 and x2 = {cov_val[idx]}&#39;)</span></span>
<span id="cb68-63"><a href="#cb68-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-64"><a href="#cb68-64" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb68-65"><a href="#cb68-65" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="classifier-deep-dive" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Classifier
deep-dive</h1>
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Groundwork (data, preprocess, decompose, model, and datashape inspection</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> timeit <span class="im">import</span> default_timer <span class="im">as</span> timer</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> linear_model, naive_bayes, svm, tree, ensemble</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPClassifier</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA, KernelPCA</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, accuracy_score</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Mutable parameters and obtain colourmap</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>n_features <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>n_classes <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="co"># higher resolutions reduce pixelation and thin out decision boundary (300)</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>resolution <span class="op">=</span> <span class="dv">300</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="co"># higher values crowd plot (100)</span></span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>n_samples<span class="op">=</span><span class="dv">1000</span></span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>cmap <span class="op">=</span> cmr.get_sub_cmap(<span class="st">&#39;gnuplot2&#39;</span>, <span class="fl">.1</span>, <span class="fl">.8</span>, N<span class="op">=</span>n_classes)</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [cmap(i)[:<span class="dv">3</span>] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(cmap.N)]</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ListedColormap(color_list)</span></span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Make data</span></span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> datasets.make_classification(</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span>n_samples, n_features<span class="op">=</span>n_features,</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>    n_informative<span class="op">=</span>n_features, n_redundant<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>    n_clusters_per_class<span class="op">=</span><span class="dv">1</span>, n_classes<span class="op">=</span>n_classes,</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>    random_state<span class="op">=</span><span class="dv">42</span>,</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">.2</span>,</span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a>                                                    random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Preprocess, decompose and project feature space for later plotting</span></span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X_train)</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a><span class="co"># dr_model = PCA(n_components=2)</span></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>dr_model <span class="op">=</span> KernelPCA(n_components<span class="op">=</span><span class="dv">2</span>, fit_inverse_transform<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>X2D <span class="op">=</span> dr_model.fit_transform(scaler.fit_transform(X_train))</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Build, fit</span></span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a><span class="co"># model = linear_model.LogisticRegression()</span></span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> naive_bayes.GaussianNB()</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a><span class="co"># model = svm.SVC(kernel=&#39;rbf&#39;, C=6, probability=True, random_state=42)</span></span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a><span class="co"># model = tree.DecisionTreeClassifier(max_depth=100)</span></span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a><span class="co"># model = ensemble.RandomForestClassifier(n_estimators=100, max_depth=100, criterion=&#39;gini&#39;)</span></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a><span class="co"># model = MLPClassifier(</span></span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a><span class="co">#     hidden_layer_sizes=np.size(X_train, 1) * 1,</span></span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a><span class="co">#     activation=&#39;relu&#39;, solver=&#39;adam&#39;,</span></span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a><span class="co">#     batch_size=round(.01 * len(X)),</span></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a><span class="co">#     alpha=.001, momentum=.9</span></span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a>t_start <span class="op">=</span> timer()</span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a>model.fit(X_scaled, y_train)</span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a>t_end <span class="op">=</span> timer()</span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a>t_elapsed <span class="op">=</span> <span class="bu">round</span>(t_end <span class="op">-</span> t_start, <span class="dv">4</span>)</span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Get projected scatter boundaries for plotting</span></span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>x_min <span class="op">=</span> X2D[:, <span class="dv">0</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> (X2D[:, <span class="dv">0</span>].<span class="bu">max</span>() <span class="op">-</span> X2D[:, <span class="dv">0</span>].<span class="bu">min</span>())</span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a>x_max <span class="op">=</span> X2D[:, <span class="dv">0</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> (X2D[:, <span class="dv">0</span>].<span class="bu">max</span>() <span class="op">-</span> X2D[:, <span class="dv">0</span>].<span class="bu">min</span>())</span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a>y_min <span class="op">=</span> X2D[:, <span class="dv">1</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> (X2D[:, <span class="dv">1</span>].<span class="bu">max</span>() <span class="op">-</span> X2D[:, <span class="dv">1</span>].<span class="bu">min</span>())</span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a>y_max <span class="op">=</span> X2D[:, <span class="dv">1</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> (X2D[:, <span class="dv">1</span>].<span class="bu">max</span>() <span class="op">-</span> X2D[:, <span class="dv">1</span>].<span class="bu">min</span>())</span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a>xrg <span class="op">=</span> [x_min, x_max]<span class="op">;</span> yrg <span class="op">=</span> [y_min, y_max]</span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a>axis <span class="op">=</span> [x_min, x_max, y_min, y_max]</span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a><span class="co"># (4a) Define projected inference grid wrt original feature space (inversion)</span></span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a>xx, yy <span class="op">=</span> np.meshgrid(</span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a>    np.arange(x_min, x_max, <span class="fl">1.</span> <span class="op">*</span> (x_max <span class="op">-</span> x_min) <span class="op">/</span> resolution),</span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a>    np.arange(y_min, y_max, <span class="fl">1.</span> <span class="op">*</span> (y_max <span class="op">-</span> y_min) <span class="op">/</span> resolution)</span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a>X_grid <span class="op">=</span> np.c_[xx.ravel(), yy.ravel()]</span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a>X_grid_inverse <span class="op">=</span> scaler.inverse_transform(dr_model.inverse_transform(X_grid))</span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a><span class="co"># assert np.all(list(zip(np.ravel(xx), np.ravel(yy))) == X_grid)</span></span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a><span class="co"># (4b) Get probabilistic and deterministic predictions over inference grid</span></span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a>Zpp <span class="op">=</span> model.predict_proba(X_grid_inverse)</span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a>Zp <span class="op">=</span> model.predict(X_grid_inverse)</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a><span class="co"># Z = svm.predict_proba(np.c_[xx.ravel(), yy.ravel()])[:, 1]</span></span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a><span class="co"># (P1) Obtain decision boundary line within projected feature space</span></span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a><span class="co"># as [...]</span></span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a>Zp_grid <span class="op">=</span> Zp.reshape(xx.shape)</span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a>Zb <span class="op">=</span> np.zeros(xx.shape)</span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a>Zb[:<span class="op">-</span><span class="dv">1</span>, :] <span class="op">=</span> np.maximum((Zp_grid[:<span class="op">-</span><span class="dv">1</span>, :] <span class="op">!=</span> Zp_grid[<span class="dv">1</span>:, :]), Zb[:<span class="op">-</span><span class="dv">1</span>, :])</span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a>Zb[<span class="dv">1</span>:, :] <span class="op">=</span> np.maximum((Zp_grid[:<span class="op">-</span><span class="dv">1</span>, :] <span class="op">!=</span> Zp_grid[<span class="dv">1</span>:, :]), Zb[<span class="dv">1</span>:, :])</span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a>Zb[:, :<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> np.maximum((Zp_grid[:, :<span class="op">-</span><span class="dv">1</span>] <span class="op">!=</span> Zp_grid[:, <span class="dv">1</span>:]), Zb[:, :<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a>Zb[:, <span class="dv">1</span>:] <span class="op">=</span> np.maximum((Zp_grid[:, :<span class="op">-</span><span class="dv">1</span>] <span class="op">!=</span> Zp_grid[:, <span class="dv">1</span>:]), Zb[:, <span class="dv">1</span>:])</span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a><span class="co"># (P2) Obtain graded probability surface within projected feature space</span></span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a><span class="co"># as [(n_samples, n_classes) probability surface] * [(n_classes, 3) color vec]</span></span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a><span class="co"># yielding (Zp_grid size) grid with RGB color vector values</span></span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> np.array(color_list[<span class="dv">0</span>:n_classes])</span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a>zz <span class="op">=</span> np.dot(Zpp, colors)</span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a>zz_r <span class="op">=</span> zz.reshape(xx.shape[<span class="dv">0</span>], xx.shape[<span class="dv">1</span>], colors.shape[<span class="dv">1</span>])</span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a><span class="co"># (1-2) Attributes, Targets &gt; Features &gt; Decomposed features &gt;</span></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a><span class="co"># (4a) Inference grid, Ravelled into features, Inverted to og feature space &gt;</span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a><span class="co"># (4b) Probabilistic + Deterministic predictions,</span></span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a><span class="co"># (P1) Unravelled into grid for plotting &gt; Decision boundary line &gt;</span></span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a><span class="co"># (P2) Colour-graded probability surface</span></span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a>display(<span class="st">&#39;X&#39;</span>, <span class="st">&#39;y&#39;</span>, <span class="st">&#39;X_scaled&#39;</span>, <span class="st">&#39;X2D&#39;</span>,</span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;xx&#39;</span>, <span class="st">&#39;yy&#39;</span>, <span class="st">&#39;X_grid&#39;</span>, <span class="st">&#39;X_grid_inverse&#39;</span>,</span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Zpp&#39;</span>, <span class="st">&#39;Zp&#39;</span>,</span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;Zp_grid&#39;</span>, <span class="st">&#39;(Zp_grid[:-1, :])&#39;</span>, <span class="st">&#39;(Zp_grid[1:, :])&#39;</span>, <span class="st">&#39;(Zb[:-1, :])&#39;</span>, <span class="st">&#39;Zb&#39;</span>,</span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;colors&#39;</span>, <span class="st">&#39;zz&#39;</span>, <span class="st">&#39;zz_r&#39;</span>,</span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a>        )</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">### Plotting: illustrative plot of probability surface</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] implement cross-validation here instead of a single train/test split</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] define search grids for each model and complexity knobs for val</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] pipe prep &amp; model &amp; plot grid/rand search results below as heat or lol</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] plot training/validation curve &amp; learning curve below on 1 line</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] incorporate all models from sklearn classifier comparison plot</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] repeat for clustering, manifold</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> mpatches</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>axis_lim <span class="op">=</span> [<span class="bu">min</span>(xrg[<span class="dv">0</span>], yrg[<span class="dv">0</span>]), <span class="bu">max</span>(xrg[<span class="dv">1</span>], yrg[<span class="dv">1</span>])]</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>axis_equal <span class="op">=</span> axis_lim <span class="op">+</span> axis_lim</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Prep test data identically to training data, evaluate</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a>X_scaled_test <span class="op">=</span> scaler.fit_transform(X_test)</span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> model.predict(X_scaled_test)</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>accuracy_val <span class="op">=</span> accuracy_score(y_pred<span class="op">=</span>y_pred, y_true<span class="op">=</span>y_test)</span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>y_pred_train <span class="op">=</span> model.predict(X_scaled)</span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>accuracy_train <span class="op">=</span> accuracy_score(y_pred<span class="op">=</span>y_pred_train, y_true<span class="op">=</span>y_train)</span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>X2D_test <span class="op">=</span> dr_model.fit_transform(X_scaled_test)</span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-24"><a href="#cb70-24" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb70-25"><a href="#cb70-25" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb70-26"><a href="#cb70-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-27"><a href="#cb70-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Boundary line</span></span>
<span id="cb70-28"><a href="#cb70-28" aria-hidden="true" tabindex="-1"></a>ax.imshow(Zb, origin<span class="op">=</span><span class="st">&#39;lower&#39;</span>, interpolation<span class="op">=</span><span class="va">None</span>, cmap<span class="op">=</span><span class="st">&#39;Greys&#39;</span>,</span>
<span id="cb70-29"><a href="#cb70-29" aria-hidden="true" tabindex="-1"></a>          alpha<span class="op">=</span><span class="fl">1.0</span>, extent<span class="op">=</span>axis_equal)</span>
<span id="cb70-30"><a href="#cb70-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-31"><a href="#cb70-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability surface</span></span>
<span id="cb70-32"><a href="#cb70-32" aria-hidden="true" tabindex="-1"></a>ax.imshow(zz_r, origin<span class="op">=</span><span class="st">&#39;lower&#39;</span>, interpolation<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb70-33"><a href="#cb70-33" aria-hidden="true" tabindex="-1"></a>          alpha<span class="op">=</span><span class="fl">.7</span>, extent<span class="op">=</span>axis_equal)</span>
<span id="cb70-34"><a href="#cb70-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-35"><a href="#cb70-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter</span></span>
<span id="cb70-36"><a href="#cb70-36" aria-hidden="true" tabindex="-1"></a>ax.scatter(X2D[:, <span class="dv">0</span>], X2D[:, <span class="dv">1</span>], c<span class="op">=</span>[colors[i, :] <span class="cf">for</span> i <span class="kw">in</span> y_train],</span>
<span id="cb70-37"><a href="#cb70-37" aria-hidden="true" tabindex="-1"></a>          <span class="co">#  linewidths=.5, edgecolors=&#39;k&#39;,</span></span>
<span id="cb70-38"><a href="#cb70-38" aria-hidden="true" tabindex="-1"></a>           )</span>
<span id="cb70-39"><a href="#cb70-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-40"><a href="#cb70-40" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb70-41"><a href="#cb70-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb70-42"><a href="#cb70-42" aria-hidden="true" tabindex="-1"></a>colors_bar <span class="op">=</span> []</span>
<span id="cb70-43"><a href="#cb70-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> v1 <span class="kw">in</span> colors[:n_classes, :]:</span>
<span id="cb70-44"><a href="#cb70-44" aria-hidden="true" tabindex="-1"></a>  v1 <span class="op">=</span> <span class="bu">list</span>(v1)</span>
<span id="cb70-45"><a href="#cb70-45" aria-hidden="true" tabindex="-1"></a>  v1.append(<span class="fl">.7</span>)</span>
<span id="cb70-46"><a href="#cb70-46" aria-hidden="true" tabindex="-1"></a>  colors_bar.append(v1)</span>
<span id="cb70-47"><a href="#cb70-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-48"><a href="#cb70-48" aria-hidden="true" tabindex="-1"></a><span class="co"># create a patch (proxy artist) for every color</span></span>
<span id="cb70-49"><a href="#cb70-49" aria-hidden="true" tabindex="-1"></a>patches <span class="op">=</span> [mpatches.Patch(color<span class="op">=</span>colors_bar[i],</span>
<span id="cb70-50"><a href="#cb70-50" aria-hidden="true" tabindex="-1"></a>                          label<span class="op">=</span><span class="st">&quot;Class </span><span class="sc">{k}</span><span class="st">&quot;</span>.<span class="bu">format</span>(k<span class="op">=</span>i))</span>
<span id="cb70-51"><a href="#cb70-51" aria-hidden="true" tabindex="-1"></a>          <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n_classes)]</span>
<span id="cb70-52"><a href="#cb70-52" aria-hidden="true" tabindex="-1"></a><span class="co"># put those patched as legend-handles into the legend</span></span>
<span id="cb70-53"><a href="#cb70-53" aria-hidden="true" tabindex="-1"></a>plt.legend(handles<span class="op">=</span>patches, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.05</span>, <span class="dv">1</span>),</span>
<span id="cb70-54"><a href="#cb70-54" aria-hidden="true" tabindex="-1"></a>            loc<span class="op">=</span><span class="dv">2</span>, borderaxespad<span class="op">=</span><span class="fl">0.</span>, framealpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb70-55"><a href="#cb70-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-56"><a href="#cb70-56" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb70-57"><a href="#cb70-57" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_aspect(&#39;equal&#39;, adjustable=&#39;box&#39;)</span></span>
<span id="cb70-58"><a href="#cb70-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-59"><a href="#cb70-59" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(axis_lim)</span>
<span id="cb70-60"><a href="#cb70-60" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(axis_lim)</span>
<span id="cb70-61"><a href="#cb70-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-62"><a href="#cb70-62" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> dr_model <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb70-63"><a href="#cb70-63" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Raw axis $x_1$&#39;</span>)</span>
<span id="cb70-64"><a href="#cb70-64" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Raw axis $x_2$&#39;</span>)</span>
<span id="cb70-65"><a href="#cb70-65" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb70-66"><a href="#cb70-66" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Dimension reduced axis 1&#39;</span>)</span>
<span id="cb70-67"><a href="#cb70-67" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Dimension reduced axis 2&#39;</span>)</span>
<span id="cb70-68"><a href="#cb70-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-69"><a href="#cb70-69" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="ss">f&quot;</span><span class="sc">{</span><span class="bu">str</span>(model)[:]<span class="sc">}</span><span class="ch">\n</span><span class="ss">decision surface&quot;</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb70-70"><a href="#cb70-70" aria-hidden="true" tabindex="-1"></a>ax.text(</span>
<span id="cb70-71"><a href="#cb70-71" aria-hidden="true" tabindex="-1"></a>    axis_lim[<span class="dv">1</span>] <span class="op">-</span> <span class="fl">0.3</span>, axis_lim[<span class="dv">0</span>] <span class="op">+</span> <span class="fl">0.3</span>,</span>
<span id="cb70-72"><a href="#cb70-72" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f&quot;Training accuracy: </span><span class="sc">{</span>accuracy_train<span class="sc">}</span><span class="ss">, Validation accuracy: </span><span class="sc">{</span>accuracy_val<span class="sc">}</span><span class="ch">\n\</span></span>
<span id="cb70-73"><a href="#cb70-73" aria-hidden="true" tabindex="-1"></a><span class="ss">    Training time: </span><span class="sc">{</span>t_elapsed<span class="sc">}</span><span class="ss">s&quot;</span>,</span>
<span id="cb70-74"><a href="#cb70-74" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="dv">9</span>,</span>
<span id="cb70-75"><a href="#cb70-75" aria-hidden="true" tabindex="-1"></a>    horizontalalignment<span class="op">=</span><span class="st">&quot;right&quot;</span>,</span>
<span id="cb70-76"><a href="#cb70-76" aria-hidden="true" tabindex="-1"></a>    bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">&quot;round&quot;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, facecolor<span class="op">=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb70-77"><a href="#cb70-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># transform=ax.transAxes,</span></span>
<span id="cb70-78"><a href="#cb70-78" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-79"><a href="#cb70-79" aria-hidden="true" tabindex="-1"></a>plt.suptitle(</span>
<span id="cb70-80"><a href="#cb70-80" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f&quot;</span><span class="sc">{</span>n_classes<span class="sc">}</span><span class="ss"> classes by </span><span class="sc">{</span>n_features<span class="sc">}</span><span class="ss"> features</span><span class="ch">\n\</span></span>
<span id="cb70-81"><a href="#cb70-81" aria-hidden="true" tabindex="-1"></a><span class="ss">    </span><span class="sc">{</span><span class="bu">len</span>(X_train)<span class="sc">}</span><span class="ss"> training samples, </span><span class="sc">{</span><span class="bu">len</span>(X_test)<span class="sc">}</span><span class="ss"> testing samples&quot;</span>,</span>
<span id="cb70-82"><a href="#cb70-82" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span><span class="dv">1</span> <span class="op">-</span> <span class="fl">.4</span>, y<span class="op">=</span><span class="dv">0</span> <span class="op">+</span> <span class="fl">.025</span>,</span>
<span id="cb70-83"><a href="#cb70-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ha=&#39;center&#39;, va=&#39;bottom&#39;,</span></span>
<span id="cb70-84"><a href="#cb70-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-85"><a href="#cb70-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Training accuracy: {accuracy_train}, Validation accuracy: {accuracy_val}\n\</span></span>
<span id="cb70-86"><a href="#cb70-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Training time: {t_elapsed} s&quot;,</span></span>
<span id="cb70-87"><a href="#cb70-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-88"><a href="#cb70-88" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb70-89"><a href="#cb70-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-90"><a href="#cb70-90" aria-hidden="true" tabindex="-1"></a><span class="co"># confusion_matrix(y_pred=y_pred, y_true=y_test)</span></span>
<span id="cb70-91"><a href="#cb70-91" aria-hidden="true" tabindex="-1"></a>confusion_matrix(y_pred<span class="op">=</span>y_pred_train, y_true<span class="op">=</span>y_train)</span></code></pre></div>
</div>
<div id="ml" class="section level1" number="13">
<h1><span class="header-section-number">13</span> ML</h1>
<div class="sourceCode" id="cb71"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2-class classifier plot with decision boundary</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> ListedColormap</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_classification</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make data and preprocess</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>n_classes <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> make_classification(n_samples<span class="op">=</span><span class="dv">500</span>, n_features<span class="op">=</span><span class="dv">2</span>,</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>                           n_informative<span class="op">=</span><span class="dv">2</span>, n_redundant<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>                           n_clusters_per_class<span class="op">=</span><span class="dv">1</span>, n_classes<span class="op">=</span>n_classes,</span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Build classifier, fit, and predict</span></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>svm <span class="op">=</span> SVC(kernel<span class="op">=</span><span class="st">&#39;rbf&#39;</span>, random_state<span class="op">=</span><span class="dv">42</span>, probability<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>svm.fit(X_scaled, y)</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>xx, yy <span class="op">=</span> np.meshgrid(np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>), np.linspace(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">100</span>))</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> svm.predict_proba(np.c_[xx.ravel(), yy.ravel()])[:, <span class="dv">1</span>]</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Z.reshape(xx.shape)</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot scatter with decision surface</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.axes_style(<span class="st">&#39;whitegrid&#39;</span>):</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a>  plt.figure()</span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>  plt.contourf(xx, yy, Z, cmap<span class="op">=</span><span class="st">&#39;PiYG&#39;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>) <span class="co"># cmap=&#39;coolwarm&#39;</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>  plt.scatter(X_scaled[:, <span class="dv">0</span>], X_scaled[:, <span class="dv">1</span>], c<span class="op">=</span>y,</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>              cmap<span class="op">=</span>ListedColormap([<span class="st">&quot;#b30065&quot;</span>, <span class="st">&quot;#178000&quot;</span>]),</span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>              <span class="co"># cmap=cmr.get_sub_cmap(&#39;PiYG&#39;, .1, .9, N=n_classes),</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>              <span class="co"># cmap=&#39;viridis&#39;,</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a>plt.xlim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>)<span class="op">;</span> plt.ylim(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Feature 1&#39;</span>)<span class="op">;</span> plt.ylabel(<span class="st">&#39;Feature 2&#39;</span>)</span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;2-class classifier with scatter and decision surface&#39;</span>)</span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets, svm</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.inspection <span class="im">import</span> DecisionBoundaryDisplay</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Data</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> datasets.load_iris()</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> iris.data[:, :<span class="dv">2</span>]  <span class="co"># only take first two features</span></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> iris.target <span class="co"># 3 classes</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Build classifier &amp; fit</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> svm.SVC(kernel<span class="op">=</span><span class="st">&#39;rbf&#39;</span>)</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>clf.fit(X, Y)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot model</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="co"># h = 0.02  # step size in the mesh</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.axes_style(<span class="st">&#39;whitegrid&#39;</span>):</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>  plt.figure()</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>  ax <span class="op">=</span> plt.gca()</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>  DecisionBoundaryDisplay.from_estimator(</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>      clf, X, ax<span class="op">=</span>ax,</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>      cmap<span class="op">=</span>plt.cm.viridis_r, grid_resolution<span class="op">=</span><span class="dv">100</span>,</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>      response_method<span class="op">=</span><span class="st">&quot;predict&quot;</span>, plot_method<span class="op">=</span><span class="st">&quot;pcolormesh&quot;</span>, shading<span class="op">=</span><span class="st">&quot;auto&quot;</span>,</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>      alpha<span class="op">=</span><span class="fl">.85</span></span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot scatter</span></span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>plt.scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], c<span class="op">=</span>Y, s<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a>            cmap<span class="op">=</span>plt.cm.viridis_r, edgecolors<span class="op">=</span><span class="st">&quot;k&quot;</span>, linewidths<span class="op">=</span><span class="dv">1</span>, alpha<span class="op">=</span><span class="fl">.85</span>,</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Feature 1&#39;</span>)<span class="op">;</span> plt.ylabel(<span class="st">&#39;Feature 2&#39;</span>)</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;3-class classifier with scatter and decision boundary&quot;</span>)</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&quot;tight&quot;</span>)</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generative kernels and graded densities</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_blobs</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.mixture <span class="im">import</span> GaussianMixture</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Get data &amp; preprocess</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> make_blobs(n_samples<span class="op">=</span><span class="dv">500</span>, centers<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">42</span>, cluster_std<span class="op">=</span><span class="fl">3.0</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>X_scaled <span class="op">=</span> scaler.fit_transform(X)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Model &amp; fit</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>gmm <span class="op">=</span> GaussianMixture(n_components<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>gmm.fit(X_scaled)</span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Build grid &amp; predict</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>x_min, x_max <span class="op">=</span> X_scaled[:, <span class="dv">0</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="dv">1</span>, X_scaled[:, <span class="dv">0</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>y_min, y_max <span class="op">=</span> X_scaled[:, <span class="dv">1</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="dv">1</span>, X_scaled[:, <span class="dv">1</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>xx, yy <span class="op">=</span> np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> <span class="op">-</span>gmm.score_samples(np.c_[xx.ravel(), yy.ravel()])</span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> Z.reshape(xx.shape)</span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot model &amp; scatter</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> sns.axes_style(<span class="st">&#39;whitegrid&#39;</span>):</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  plt.figure()</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>  plt.contourf(xx, yy, Z, levels<span class="op">=</span><span class="dv">20</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, cmap<span class="op">=</span><span class="st">&#39;viridis&#39;</span>)</span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a>  scatter <span class="op">=</span> sns.scatterplot(</span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>      x<span class="op">=</span>X_scaled[:, <span class="dv">0</span>], y<span class="op">=</span>X_scaled[:, <span class="dv">1</span>], hue<span class="op">=</span>y, s<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>      palette<span class="op">=</span><span class="st">&#39;pastel&#39;</span>, edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>, alpha<span class="op">=</span><span class="fl">.9</span>,</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot centers</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>  plt.scatter(</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>      gmm.means_[:, <span class="dv">0</span>], gmm.means_[:, <span class="dv">1</span>],</span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># color=&#39;red&#39;, marker=&#39;o&#39;, s=30, alpha=.85,</span></span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>      color<span class="op">=</span><span class="st">&#39;white&#39;</span>, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, s<span class="op">=</span><span class="dv">75</span>,</span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>      edgecolor<span class="op">=</span><span class="st">&#39;black&#39;</span>, linewidths<span class="op">=</span><span class="fl">.5</span>,</span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Feature 1&#39;</span>)<span class="op">;</span> plt.ylabel(<span class="st">&#39;Feature 2&#39;</span>)</span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>plt.xlim(x_min, x_max)<span class="op">;</span> plt.ylim(y_min, y_max)</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;3-class clustering with scatter and densities&#39;</span>)</span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>handles, labels <span class="op">=</span> scatter.get_legend_handles_labels()</span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>plt.legend(handles, [<span class="st">&#39;Cluster &#39;</span> <span class="op">+</span> item <span class="cf">for</span> item <span class="kw">in</span> labels],</span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>           loc<span class="op">=</span><span class="st">&#39;best&#39;</span>, <span class="co">#bbox_to_anchor=(1, 0.5),</span></span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>           frameon<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>
<div id="model-comparison-routines-dataset-x-modelhyperparameter"
class="section level1" number="14">
<h1><span class="header-section-number">14</span> Model comparison
routines (dataset x model/hyperparameter)</h1>
<div class="sourceCode" id="cb74"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Code source: Gaël Varoquaux</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co">#              Andreas Müller</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Modified for documentation by Jaques Grobler</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># License: BSD 3 clause</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> ListedColormap</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_circles, make_classification, make_moons</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.discriminant_analysis <span class="im">import</span> QuadraticDiscriminantAnalysis</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> AdaBoostClassifier, RandomForestClassifier</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.gaussian_process <span class="im">import</span> GaussianProcessClassifier</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.gaussian_process.kernels <span class="im">import</span> RBF</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.inspection <span class="im">import</span> DecisionBoundaryDisplay</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neural_network <span class="im">import</span> MLPClassifier</span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a><span class="co">## Make models</span></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a>names <span class="op">=</span> [</span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &quot;Nearest Neighbors&quot;,</span></span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &quot;Linear SVM&quot;,</span></span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;RBF SVM&quot;</span>,</span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &quot;Gaussian Process&quot;,</span></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Decision Tree&quot;</span>,</span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Random Forest&quot;</span>,</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Neural Net&quot;</span>,</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &quot;AdaBoost&quot;,</span></span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Naive Bayes&quot;</span>,</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a>    <span class="co"># &quot;QDA&quot;,</span></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a>classifiers <span class="op">=</span> [</span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># KNeighborsClassifier(3),</span></span>
<span id="cb74-41"><a href="#cb74-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># SVC(kernel=&quot;linear&quot;, C=0.025, random_state=42),</span></span>
<span id="cb74-42"><a href="#cb74-42" aria-hidden="true" tabindex="-1"></a>    SVC(gamma<span class="op">=</span><span class="dv">2</span>, C<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb74-43"><a href="#cb74-43" aria-hidden="true" tabindex="-1"></a>    <span class="co"># GaussianProcessClassifier(1.0 * RBF(1.0), random_state=42),</span></span>
<span id="cb74-44"><a href="#cb74-44" aria-hidden="true" tabindex="-1"></a>    DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">5</span>, random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb74-45"><a href="#cb74-45" aria-hidden="true" tabindex="-1"></a>    RandomForestClassifier(</span>
<span id="cb74-46"><a href="#cb74-46" aria-hidden="true" tabindex="-1"></a>        max_depth<span class="op">=</span><span class="dv">5</span>, n_estimators<span class="op">=</span><span class="dv">10</span>, max_features<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb74-47"><a href="#cb74-47" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb74-48"><a href="#cb74-48" aria-hidden="true" tabindex="-1"></a>    MLPClassifier(alpha<span class="op">=</span><span class="dv">1</span>, max_iter<span class="op">=</span><span class="dv">1000</span>, random_state<span class="op">=</span><span class="dv">42</span>),</span>
<span id="cb74-49"><a href="#cb74-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># AdaBoostClassifier(algorithm=&quot;SAMME&quot;, random_state=42),</span></span>
<span id="cb74-50"><a href="#cb74-50" aria-hidden="true" tabindex="-1"></a>    GaussianNB(),</span>
<span id="cb74-51"><a href="#cb74-51" aria-hidden="true" tabindex="-1"></a>    <span class="co"># QuadraticDiscriminantAnalysis(),</span></span>
<span id="cb74-52"><a href="#cb74-52" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb74-53"><a href="#cb74-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-54"><a href="#cb74-54" aria-hidden="true" tabindex="-1"></a><span class="co">## Make datasets</span></span>
<span id="cb74-55"><a href="#cb74-55" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> make_classification(</span>
<span id="cb74-56"><a href="#cb74-56" aria-hidden="true" tabindex="-1"></a>    n_features<span class="op">=</span><span class="dv">2</span>, n_redundant<span class="op">=</span><span class="dv">0</span>, n_informative<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">1</span>, n_clusters_per_class<span class="op">=</span><span class="dv">1</span></span>
<span id="cb74-57"><a href="#cb74-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-58"><a href="#cb74-58" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">2</span>)</span>
<span id="cb74-59"><a href="#cb74-59" aria-hidden="true" tabindex="-1"></a>X <span class="op">+=</span> <span class="dv">2</span> <span class="op">*</span> rng.uniform(size<span class="op">=</span>X.shape)</span>
<span id="cb74-60"><a href="#cb74-60" aria-hidden="true" tabindex="-1"></a>linearly_separable <span class="op">=</span> (X, y)</span>
<span id="cb74-61"><a href="#cb74-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-62"><a href="#cb74-62" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> [</span>
<span id="cb74-63"><a href="#cb74-63" aria-hidden="true" tabindex="-1"></a>    make_moons(noise<span class="op">=</span><span class="fl">0.3</span>, random_state<span class="op">=</span><span class="dv">0</span>),</span>
<span id="cb74-64"><a href="#cb74-64" aria-hidden="true" tabindex="-1"></a>    make_circles(noise<span class="op">=</span><span class="fl">0.2</span>, factor<span class="op">=</span><span class="fl">0.5</span>, random_state<span class="op">=</span><span class="dv">1</span>),</span>
<span id="cb74-65"><a href="#cb74-65" aria-hidden="true" tabindex="-1"></a>    linearly_separable,</span>
<span id="cb74-66"><a href="#cb74-66" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb74-67"><a href="#cb74-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-68"><a href="#cb74-68" aria-hidden="true" tabindex="-1"></a><span class="co">## Plot</span></span>
<span id="cb74-69"><a href="#cb74-69" aria-hidden="true" tabindex="-1"></a>figure <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>)) <span class="co"># figure = plt.figure(figsize=(27, 9))</span></span>
<span id="cb74-70"><a href="#cb74-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-71"><a href="#cb74-71" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over datasets</span></span>
<span id="cb74-72"><a href="#cb74-72" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb74-73"><a href="#cb74-73" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ds_cnt, ds <span class="kw">in</span> <span class="bu">enumerate</span>(datasets):</span>
<span id="cb74-74"><a href="#cb74-74" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Split into training and test part</span></span>
<span id="cb74-75"><a href="#cb74-75" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> ds</span>
<span id="cb74-76"><a href="#cb74-76" aria-hidden="true" tabindex="-1"></a>    X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(</span>
<span id="cb74-77"><a href="#cb74-77" aria-hidden="true" tabindex="-1"></a>        X, y, test_size<span class="op">=</span><span class="fl">0.4</span>, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb74-78"><a href="#cb74-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-79"><a href="#cb74-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-80"><a href="#cb74-80" aria-hidden="true" tabindex="-1"></a>    x_min, x_max <span class="op">=</span> X[:, <span class="dv">0</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="fl">0.5</span>, X[:, <span class="dv">0</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="fl">0.5</span></span>
<span id="cb74-81"><a href="#cb74-81" aria-hidden="true" tabindex="-1"></a>    y_min, y_max <span class="op">=</span> X[:, <span class="dv">1</span>].<span class="bu">min</span>() <span class="op">-</span> <span class="fl">0.5</span>, X[:, <span class="dv">1</span>].<span class="bu">max</span>() <span class="op">+</span> <span class="fl">0.5</span></span>
<span id="cb74-82"><a href="#cb74-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-83"><a href="#cb74-83" aria-hidden="true" tabindex="-1"></a>    <span class="co">## Plot the dataset</span></span>
<span id="cb74-84"><a href="#cb74-84" aria-hidden="true" tabindex="-1"></a>    cm <span class="op">=</span> plt.cm.PiYG <span class="co"># cm = plt.cm.RdBu</span></span>
<span id="cb74-85"><a href="#cb74-85" aria-hidden="true" tabindex="-1"></a>    cm_bright <span class="op">=</span> ListedColormap([<span class="st">&quot;#b30065&quot;</span>, <span class="st">&quot;#178000&quot;</span>]) <span class="co"># cm_bright = ListedColormap([&quot;#FF0000&quot;, &quot;#0000FF&quot;])</span></span>
<span id="cb74-86"><a href="#cb74-86" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.subplot(<span class="bu">len</span>(datasets), <span class="bu">len</span>(classifiers) <span class="op">+</span> <span class="dv">1</span>, i)</span>
<span id="cb74-87"><a href="#cb74-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ds_cnt <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb74-88"><a href="#cb74-88" aria-hidden="true" tabindex="-1"></a>        ax.set_title(<span class="st">&quot;Input data&quot;</span>)</span>
<span id="cb74-89"><a href="#cb74-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-90"><a href="#cb74-90" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the training points &amp; testing points (latter slightly faded)</span></span>
<span id="cb74-91"><a href="#cb74-91" aria-hidden="true" tabindex="-1"></a>    ax.scatter(X_train[:, <span class="dv">0</span>], X_train[:, <span class="dv">1</span>], c<span class="op">=</span>y_train,</span>
<span id="cb74-92"><a href="#cb74-92" aria-hidden="true" tabindex="-1"></a>               cmap<span class="op">=</span>cm_bright, edgecolors<span class="op">=</span><span class="st">&quot;k&quot;</span>,</span>
<span id="cb74-93"><a href="#cb74-93" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-94"><a href="#cb74-94" aria-hidden="true" tabindex="-1"></a>    ax.scatter(X_test[:, <span class="dv">0</span>], X_test[:, <span class="dv">1</span>], c<span class="op">=</span>y_test,</span>
<span id="cb74-95"><a href="#cb74-95" aria-hidden="true" tabindex="-1"></a>               cmap<span class="op">=</span>cm_bright, edgecolors<span class="op">=</span><span class="st">&quot;k&quot;</span>, alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb74-96"><a href="#cb74-96" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb74-97"><a href="#cb74-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-98"><a href="#cb74-98" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plotting adjustments</span></span>
<span id="cb74-99"><a href="#cb74-99" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(x_min, x_max)</span>
<span id="cb74-100"><a href="#cb74-100" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(y_min, y_max)</span>
<span id="cb74-101"><a href="#cb74-101" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks(())</span>
<span id="cb74-102"><a href="#cb74-102" aria-hidden="true" tabindex="-1"></a>    ax.set_yticks(())</span>
<span id="cb74-103"><a href="#cb74-103" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb74-104"><a href="#cb74-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-105"><a href="#cb74-105" aria-hidden="true" tabindex="-1"></a>    <span class="co"># iterate over classifiers</span></span>
<span id="cb74-106"><a href="#cb74-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, clf <span class="kw">in</span> <span class="bu">zip</span>(names, classifiers):</span>
<span id="cb74-107"><a href="#cb74-107" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> plt.subplot(<span class="bu">len</span>(datasets), <span class="bu">len</span>(classifiers) <span class="op">+</span> <span class="dv">1</span>, i)</span>
<span id="cb74-108"><a href="#cb74-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-109"><a href="#cb74-109" aria-hidden="true" tabindex="-1"></a>        <span class="co">## Preprocess, fit, and plot fit</span></span>
<span id="cb74-110"><a href="#cb74-110" aria-hidden="true" tabindex="-1"></a>        clf <span class="op">=</span> make_pipeline(StandardScaler(), clf)</span>
<span id="cb74-111"><a href="#cb74-111" aria-hidden="true" tabindex="-1"></a>        clf.fit(X_train, y_train)</span>
<span id="cb74-112"><a href="#cb74-112" aria-hidden="true" tabindex="-1"></a>        score <span class="op">=</span> clf.score(X_test, y_test)</span>
<span id="cb74-113"><a href="#cb74-113" aria-hidden="true" tabindex="-1"></a>        DecisionBoundaryDisplay.from_estimator(</span>
<span id="cb74-114"><a href="#cb74-114" aria-hidden="true" tabindex="-1"></a>            clf, X, cmap<span class="op">=</span>cm, alpha<span class="op">=</span><span class="fl">0.8</span>, ax<span class="op">=</span>ax, eps<span class="op">=</span><span class="fl">0.5</span></span>
<span id="cb74-115"><a href="#cb74-115" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb74-116"><a href="#cb74-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-117"><a href="#cb74-117" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plot the training points &amp; testing points (latter slightly faded)</span></span>
<span id="cb74-118"><a href="#cb74-118" aria-hidden="true" tabindex="-1"></a>        ax.scatter(X_train[:, <span class="dv">0</span>], X_train[:, <span class="dv">1</span>], c<span class="op">=</span>y_train,</span>
<span id="cb74-119"><a href="#cb74-119" aria-hidden="true" tabindex="-1"></a>                   cmap<span class="op">=</span>cm_bright, edgecolors<span class="op">=</span><span class="st">&quot;k&quot;</span>,</span>
<span id="cb74-120"><a href="#cb74-120" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb74-121"><a href="#cb74-121" aria-hidden="true" tabindex="-1"></a>        ax.scatter(X_test[:, <span class="dv">0</span>], X_test[:, <span class="dv">1</span>], c<span class="op">=</span>y_test,</span>
<span id="cb74-122"><a href="#cb74-122" aria-hidden="true" tabindex="-1"></a>                   cmap<span class="op">=</span>cm_bright, edgecolors<span class="op">=</span><span class="st">&quot;k&quot;</span>, alpha<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb74-123"><a href="#cb74-123" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb74-124"><a href="#cb74-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-125"><a href="#cb74-125" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Plotting adjustments &amp; annotation</span></span>
<span id="cb74-126"><a href="#cb74-126" aria-hidden="true" tabindex="-1"></a>        ax.set_xlim(x_min, x_max)</span>
<span id="cb74-127"><a href="#cb74-127" aria-hidden="true" tabindex="-1"></a>        ax.set_ylim(y_min, y_max)</span>
<span id="cb74-128"><a href="#cb74-128" aria-hidden="true" tabindex="-1"></a>        ax.set_xticks(())</span>
<span id="cb74-129"><a href="#cb74-129" aria-hidden="true" tabindex="-1"></a>        ax.set_yticks(())</span>
<span id="cb74-130"><a href="#cb74-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> ds_cnt <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb74-131"><a href="#cb74-131" aria-hidden="true" tabindex="-1"></a>            ax.set_title(name)</span>
<span id="cb74-132"><a href="#cb74-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-133"><a href="#cb74-133" aria-hidden="true" tabindex="-1"></a>        ax.text(</span>
<span id="cb74-134"><a href="#cb74-134" aria-hidden="true" tabindex="-1"></a>            x_max <span class="op">-</span> <span class="fl">0.3</span>,</span>
<span id="cb74-135"><a href="#cb74-135" aria-hidden="true" tabindex="-1"></a>            y_min <span class="op">+</span> <span class="fl">0.3</span>,</span>
<span id="cb74-136"><a href="#cb74-136" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&quot;</span><span class="sc">%.2f</span><span class="st">&quot;</span> <span class="op">%</span> score).lstrip(<span class="st">&quot;0&quot;</span>),</span>
<span id="cb74-137"><a href="#cb74-137" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span><span class="dv">12</span>,</span>
<span id="cb74-138"><a href="#cb74-138" aria-hidden="true" tabindex="-1"></a>            horizontalalignment<span class="op">=</span><span class="st">&quot;right&quot;</span>,</span>
<span id="cb74-139"><a href="#cb74-139" aria-hidden="true" tabindex="-1"></a>            bbox<span class="op">=</span><span class="bu">dict</span>(boxstyle<span class="op">=</span><span class="st">&quot;round&quot;</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, facecolor<span class="op">=</span><span class="st">&quot;white&quot;</span>),</span>
<span id="cb74-140"><a href="#cb74-140" aria-hidden="true" tabindex="-1"></a>            <span class="co"># transform=ax.transAxes,</span></span>
<span id="cb74-141"><a href="#cb74-141" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb74-142"><a href="#cb74-142" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb74-143"><a href="#cb74-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-144"><a href="#cb74-144" aria-hidden="true" tabindex="-1"></a>figure.suptitle(<span class="st">&#39;Classifier comparison&#39;</span>)</span>
<span id="cb74-145"><a href="#cb74-145" aria-hidden="true" tabindex="-1"></a><span class="co"># figure.supxlabel(&#39;x&#39;)</span></span>
<span id="cb74-146"><a href="#cb74-146" aria-hidden="true" tabindex="-1"></a><span class="co"># figure.supylabel(&#39;y&#39;)</span></span>
<span id="cb74-147"><a href="#cb74-147" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb74-148"><a href="#cb74-148" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] polish this</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> cycle, islice</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> cluster, datasets, mixture</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> kneighbors_graph</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ============</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate datasets. We choose the size big enough to see the scalability</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="co"># of the algorithms, but not too big to avoid too long running times</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="co"># ============</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">500</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">30</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>noisy_circles <span class="op">=</span> datasets.make_circles(</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span>n_samples, factor<span class="op">=</span><span class="fl">0.5</span>, noise<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span>seed</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>noisy_moons <span class="op">=</span> datasets.make_moons(n_samples<span class="op">=</span>n_samples, noise<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span>seed)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>blobs <span class="op">=</span> datasets.make_blobs(n_samples<span class="op">=</span>n_samples, random_state<span class="op">=</span>seed)</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> np.random.RandomState(seed)</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>no_structure <span class="op">=</span> rng.rand(n_samples, <span class="dv">2</span>), <span class="va">None</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Anisotropicly distributed data</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>random_state <span class="op">=</span> <span class="dv">170</span></span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>X, y <span class="op">=</span> datasets.make_blobs(n_samples<span class="op">=</span>n_samples, random_state<span class="op">=</span>random_state)</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>transformation <span class="op">=</span> [[<span class="fl">0.6</span>, <span class="op">-</span><span class="fl">0.6</span>], [<span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.8</span>]]</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>X_aniso <span class="op">=</span> np.dot(X, transformation)</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>aniso <span class="op">=</span> (X_aniso, y)</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a><span class="co"># blobs with varied variances</span></span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>varied <span class="op">=</span> datasets.make_blobs(</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>    n_samples<span class="op">=</span>n_samples, cluster_std<span class="op">=</span>[<span class="fl">1.0</span>, <span class="fl">2.5</span>, <span class="fl">0.5</span>], random_state<span class="op">=</span>random_state</span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a><span class="co"># ============</span></span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up cluster parameters</span></span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a><span class="co"># ============</span></span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">8</span>)) <span class="co"># (9 * 2 + 3, 13)</span></span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(</span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a>    left<span class="op">=</span><span class="fl">0.02</span>, right<span class="op">=</span><span class="fl">0.98</span>, bottom<span class="op">=</span><span class="fl">0.001</span>, top<span class="op">=</span><span class="fl">0.95</span>, wspace<span class="op">=</span><span class="fl">0.05</span>, hspace<span class="op">=</span><span class="fl">0.01</span></span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>plot_num <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>default_base <span class="op">=</span> {</span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;quantile&quot;</span>: <span class="fl">0.3</span>,</span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;eps&quot;</span>: <span class="fl">0.3</span>,</span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;damping&quot;</span>: <span class="fl">0.9</span>,</span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;preference&quot;</span>: <span class="op">-</span><span class="dv">200</span>,</span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;n_neighbors&quot;</span>: <span class="dv">3</span>,</span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;n_clusters&quot;</span>: <span class="dv">3</span>,</span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;min_samples&quot;</span>: <span class="dv">7</span>,</span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;xi&quot;</span>: <span class="fl">0.05</span>,</span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;min_cluster_size&quot;</span>: <span class="fl">0.1</span>,</span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;allow_single_cluster&quot;</span>: <span class="va">True</span>,</span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hdbscan_min_cluster_size&quot;</span>: <span class="dv">15</span>,</span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;hdbscan_min_samples&quot;</span>: <span class="dv">3</span>,</span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;random_state&quot;</span>: <span class="dv">42</span>,</span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a>datasets <span class="op">=</span> [</span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a>        noisy_circles,</span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;damping&quot;</span>: <span class="fl">0.77</span>,</span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;preference&quot;</span>: <span class="op">-</span><span class="dv">240</span>,</span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;quantile&quot;</span>: <span class="fl">0.2</span>,</span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;n_clusters&quot;</span>: <span class="dv">2</span>,</span>
<span id="cb75-73"><a href="#cb75-73" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;min_samples&quot;</span>: <span class="dv">7</span>,</span>
<span id="cb75-74"><a href="#cb75-74" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;xi&quot;</span>: <span class="fl">0.08</span>,</span>
<span id="cb75-75"><a href="#cb75-75" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb75-76"><a href="#cb75-76" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb75-77"><a href="#cb75-77" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb75-78"><a href="#cb75-78" aria-hidden="true" tabindex="-1"></a>        noisy_moons,</span>
<span id="cb75-79"><a href="#cb75-79" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb75-80"><a href="#cb75-80" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;damping&quot;</span>: <span class="fl">0.75</span>,</span>
<span id="cb75-81"><a href="#cb75-81" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;preference&quot;</span>: <span class="op">-</span><span class="dv">220</span>,</span>
<span id="cb75-82"><a href="#cb75-82" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;n_clusters&quot;</span>: <span class="dv">2</span>,</span>
<span id="cb75-83"><a href="#cb75-83" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;min_samples&quot;</span>: <span class="dv">7</span>,</span>
<span id="cb75-84"><a href="#cb75-84" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;xi&quot;</span>: <span class="fl">0.1</span>,</span>
<span id="cb75-85"><a href="#cb75-85" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb75-86"><a href="#cb75-86" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb75-87"><a href="#cb75-87" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb75-88"><a href="#cb75-88" aria-hidden="true" tabindex="-1"></a>        varied,</span>
<span id="cb75-89"><a href="#cb75-89" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb75-90"><a href="#cb75-90" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;eps&quot;</span>: <span class="fl">0.18</span>,</span>
<span id="cb75-91"><a href="#cb75-91" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;n_neighbors&quot;</span>: <span class="dv">2</span>,</span>
<span id="cb75-92"><a href="#cb75-92" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;min_samples&quot;</span>: <span class="dv">7</span>,</span>
<span id="cb75-93"><a href="#cb75-93" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;xi&quot;</span>: <span class="fl">0.01</span>,</span>
<span id="cb75-94"><a href="#cb75-94" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;min_cluster_size&quot;</span>: <span class="fl">0.2</span>,</span>
<span id="cb75-95"><a href="#cb75-95" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb75-96"><a href="#cb75-96" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb75-97"><a href="#cb75-97" aria-hidden="true" tabindex="-1"></a>    (</span>
<span id="cb75-98"><a href="#cb75-98" aria-hidden="true" tabindex="-1"></a>        aniso,</span>
<span id="cb75-99"><a href="#cb75-99" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb75-100"><a href="#cb75-100" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;eps&quot;</span>: <span class="fl">0.15</span>,</span>
<span id="cb75-101"><a href="#cb75-101" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;n_neighbors&quot;</span>: <span class="dv">2</span>,</span>
<span id="cb75-102"><a href="#cb75-102" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;min_samples&quot;</span>: <span class="dv">7</span>,</span>
<span id="cb75-103"><a href="#cb75-103" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;xi&quot;</span>: <span class="fl">0.1</span>,</span>
<span id="cb75-104"><a href="#cb75-104" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;min_cluster_size&quot;</span>: <span class="fl">0.2</span>,</span>
<span id="cb75-105"><a href="#cb75-105" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb75-106"><a href="#cb75-106" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb75-107"><a href="#cb75-107" aria-hidden="true" tabindex="-1"></a>    (blobs, {<span class="st">&quot;min_samples&quot;</span>: <span class="dv">7</span>, <span class="st">&quot;xi&quot;</span>: <span class="fl">0.1</span>, <span class="st">&quot;min_cluster_size&quot;</span>: <span class="fl">0.2</span>}),</span>
<span id="cb75-108"><a href="#cb75-108" aria-hidden="true" tabindex="-1"></a>    (no_structure, {}),</span>
<span id="cb75-109"><a href="#cb75-109" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb75-110"><a href="#cb75-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-111"><a href="#cb75-111" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i_dataset, (dataset, algo_params) <span class="kw">in</span> <span class="bu">enumerate</span>(datasets):</span>
<span id="cb75-112"><a href="#cb75-112" aria-hidden="true" tabindex="-1"></a>    <span class="co"># update parameters with dataset-specific values</span></span>
<span id="cb75-113"><a href="#cb75-113" aria-hidden="true" tabindex="-1"></a>    params <span class="op">=</span> default_base.copy()</span>
<span id="cb75-114"><a href="#cb75-114" aria-hidden="true" tabindex="-1"></a>    params.update(algo_params)</span>
<span id="cb75-115"><a href="#cb75-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-116"><a href="#cb75-116" aria-hidden="true" tabindex="-1"></a>    X, y <span class="op">=</span> dataset</span>
<span id="cb75-117"><a href="#cb75-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-118"><a href="#cb75-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># normalize dataset for easier parameter selection</span></span>
<span id="cb75-119"><a href="#cb75-119" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> StandardScaler().fit_transform(X)</span>
<span id="cb75-120"><a href="#cb75-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-121"><a href="#cb75-121" aria-hidden="true" tabindex="-1"></a>    <span class="co"># estimate bandwidth for mean shift</span></span>
<span id="cb75-122"><a href="#cb75-122" aria-hidden="true" tabindex="-1"></a>    bandwidth <span class="op">=</span> cluster.estimate_bandwidth(X, quantile<span class="op">=</span>params[<span class="st">&quot;quantile&quot;</span>])</span>
<span id="cb75-123"><a href="#cb75-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-124"><a href="#cb75-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># connectivity matrix for structured Ward</span></span>
<span id="cb75-125"><a href="#cb75-125" aria-hidden="true" tabindex="-1"></a>    connectivity <span class="op">=</span> kneighbors_graph(</span>
<span id="cb75-126"><a href="#cb75-126" aria-hidden="true" tabindex="-1"></a>        X, n_neighbors<span class="op">=</span>params[<span class="st">&quot;n_neighbors&quot;</span>], include_self<span class="op">=</span><span class="va">False</span></span>
<span id="cb75-127"><a href="#cb75-127" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-128"><a href="#cb75-128" aria-hidden="true" tabindex="-1"></a>    <span class="co"># make connectivity symmetric</span></span>
<span id="cb75-129"><a href="#cb75-129" aria-hidden="true" tabindex="-1"></a>    connectivity <span class="op">=</span> <span class="fl">0.5</span> <span class="op">*</span> (connectivity <span class="op">+</span> connectivity.T)</span>
<span id="cb75-130"><a href="#cb75-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-131"><a href="#cb75-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ============</span></span>
<span id="cb75-132"><a href="#cb75-132" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create cluster objects</span></span>
<span id="cb75-133"><a href="#cb75-133" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ============</span></span>
<span id="cb75-134"><a href="#cb75-134" aria-hidden="true" tabindex="-1"></a>    ms <span class="op">=</span> cluster.MeanShift(bandwidth<span class="op">=</span>bandwidth, bin_seeding<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-135"><a href="#cb75-135" aria-hidden="true" tabindex="-1"></a>    two_means <span class="op">=</span> cluster.MiniBatchKMeans(</span>
<span id="cb75-136"><a href="#cb75-136" aria-hidden="true" tabindex="-1"></a>        n_clusters<span class="op">=</span>params[<span class="st">&quot;n_clusters&quot;</span>],</span>
<span id="cb75-137"><a href="#cb75-137" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span>params[<span class="st">&quot;random_state&quot;</span>],</span>
<span id="cb75-138"><a href="#cb75-138" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-139"><a href="#cb75-139" aria-hidden="true" tabindex="-1"></a>    ward <span class="op">=</span> cluster.AgglomerativeClustering(</span>
<span id="cb75-140"><a href="#cb75-140" aria-hidden="true" tabindex="-1"></a>        n_clusters<span class="op">=</span>params[<span class="st">&quot;n_clusters&quot;</span>], linkage<span class="op">=</span><span class="st">&quot;ward&quot;</span>, connectivity<span class="op">=</span>connectivity</span>
<span id="cb75-141"><a href="#cb75-141" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-142"><a href="#cb75-142" aria-hidden="true" tabindex="-1"></a>    spectral <span class="op">=</span> cluster.SpectralClustering(</span>
<span id="cb75-143"><a href="#cb75-143" aria-hidden="true" tabindex="-1"></a>        n_clusters<span class="op">=</span>params[<span class="st">&quot;n_clusters&quot;</span>],</span>
<span id="cb75-144"><a href="#cb75-144" aria-hidden="true" tabindex="-1"></a>        eigen_solver<span class="op">=</span><span class="st">&quot;arpack&quot;</span>,</span>
<span id="cb75-145"><a href="#cb75-145" aria-hidden="true" tabindex="-1"></a>        affinity<span class="op">=</span><span class="st">&quot;nearest_neighbors&quot;</span>,</span>
<span id="cb75-146"><a href="#cb75-146" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span>params[<span class="st">&quot;random_state&quot;</span>],</span>
<span id="cb75-147"><a href="#cb75-147" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-148"><a href="#cb75-148" aria-hidden="true" tabindex="-1"></a>    dbscan <span class="op">=</span> cluster.DBSCAN(eps<span class="op">=</span>params[<span class="st">&quot;eps&quot;</span>])</span>
<span id="cb75-149"><a href="#cb75-149" aria-hidden="true" tabindex="-1"></a>    <span class="co"># hdbscan = cluster.HDBSCAN(</span></span>
<span id="cb75-150"><a href="#cb75-150" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     min_samples=params[&quot;hdbscan_min_samples&quot;],</span></span>
<span id="cb75-151"><a href="#cb75-151" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     min_cluster_size=params[&quot;hdbscan_min_cluster_size&quot;],</span></span>
<span id="cb75-152"><a href="#cb75-152" aria-hidden="true" tabindex="-1"></a>    <span class="co">#     allow_single_cluster=params[&quot;allow_single_cluster&quot;],</span></span>
<span id="cb75-153"><a href="#cb75-153" aria-hidden="true" tabindex="-1"></a>    <span class="co"># )</span></span>
<span id="cb75-154"><a href="#cb75-154" aria-hidden="true" tabindex="-1"></a>    optics <span class="op">=</span> cluster.OPTICS(</span>
<span id="cb75-155"><a href="#cb75-155" aria-hidden="true" tabindex="-1"></a>        min_samples<span class="op">=</span>params[<span class="st">&quot;min_samples&quot;</span>],</span>
<span id="cb75-156"><a href="#cb75-156" aria-hidden="true" tabindex="-1"></a>        xi<span class="op">=</span>params[<span class="st">&quot;xi&quot;</span>],</span>
<span id="cb75-157"><a href="#cb75-157" aria-hidden="true" tabindex="-1"></a>        min_cluster_size<span class="op">=</span>params[<span class="st">&quot;min_cluster_size&quot;</span>],</span>
<span id="cb75-158"><a href="#cb75-158" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-159"><a href="#cb75-159" aria-hidden="true" tabindex="-1"></a>    affinity_propagation <span class="op">=</span> cluster.AffinityPropagation(</span>
<span id="cb75-160"><a href="#cb75-160" aria-hidden="true" tabindex="-1"></a>        damping<span class="op">=</span>params[<span class="st">&quot;damping&quot;</span>],</span>
<span id="cb75-161"><a href="#cb75-161" aria-hidden="true" tabindex="-1"></a>        preference<span class="op">=</span>params[<span class="st">&quot;preference&quot;</span>],</span>
<span id="cb75-162"><a href="#cb75-162" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span>params[<span class="st">&quot;random_state&quot;</span>],</span>
<span id="cb75-163"><a href="#cb75-163" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-164"><a href="#cb75-164" aria-hidden="true" tabindex="-1"></a>    average_linkage <span class="op">=</span> cluster.AgglomerativeClustering(</span>
<span id="cb75-165"><a href="#cb75-165" aria-hidden="true" tabindex="-1"></a>        linkage<span class="op">=</span><span class="st">&quot;average&quot;</span>,</span>
<span id="cb75-166"><a href="#cb75-166" aria-hidden="true" tabindex="-1"></a>        metric<span class="op">=</span><span class="st">&quot;cityblock&quot;</span>,</span>
<span id="cb75-167"><a href="#cb75-167" aria-hidden="true" tabindex="-1"></a>        n_clusters<span class="op">=</span>params[<span class="st">&quot;n_clusters&quot;</span>],</span>
<span id="cb75-168"><a href="#cb75-168" aria-hidden="true" tabindex="-1"></a>        connectivity<span class="op">=</span>connectivity,</span>
<span id="cb75-169"><a href="#cb75-169" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-170"><a href="#cb75-170" aria-hidden="true" tabindex="-1"></a>    birch <span class="op">=</span> cluster.Birch(n_clusters<span class="op">=</span>params[<span class="st">&quot;n_clusters&quot;</span>])</span>
<span id="cb75-171"><a href="#cb75-171" aria-hidden="true" tabindex="-1"></a>    gmm <span class="op">=</span> mixture.GaussianMixture(</span>
<span id="cb75-172"><a href="#cb75-172" aria-hidden="true" tabindex="-1"></a>        n_components<span class="op">=</span>params[<span class="st">&quot;n_clusters&quot;</span>],</span>
<span id="cb75-173"><a href="#cb75-173" aria-hidden="true" tabindex="-1"></a>        covariance_type<span class="op">=</span><span class="st">&quot;full&quot;</span>,</span>
<span id="cb75-174"><a href="#cb75-174" aria-hidden="true" tabindex="-1"></a>        random_state<span class="op">=</span>params[<span class="st">&quot;random_state&quot;</span>],</span>
<span id="cb75-175"><a href="#cb75-175" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-176"><a href="#cb75-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-177"><a href="#cb75-177" aria-hidden="true" tabindex="-1"></a>    clustering_algorithms <span class="op">=</span> (</span>
<span id="cb75-178"><a href="#cb75-178" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;MiniBatch</span><span class="ch">\n</span><span class="st">KMeans&quot;</span>, two_means),</span>
<span id="cb75-179"><a href="#cb75-179" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;Affinity</span><span class="ch">\n</span><span class="st">Propagation&quot;</span>, affinity_propagation),</span>
<span id="cb75-180"><a href="#cb75-180" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;MeanShift&quot;</span>, ms),</span>
<span id="cb75-181"><a href="#cb75-181" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;Spectral</span><span class="ch">\n</span><span class="st">Clustering&quot;</span>, spectral),</span>
<span id="cb75-182"><a href="#cb75-182" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;Ward&quot;</span>, ward),</span>
<span id="cb75-183"><a href="#cb75-183" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;Agglomerative</span><span class="ch">\n</span><span class="st">Clustering&quot;</span>, average_linkage),</span>
<span id="cb75-184"><a href="#cb75-184" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;DBSCAN&quot;</span>, dbscan),</span>
<span id="cb75-185"><a href="#cb75-185" aria-hidden="true" tabindex="-1"></a>        <span class="co"># (&quot;HDBSCAN&quot;, hdbscan),</span></span>
<span id="cb75-186"><a href="#cb75-186" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;OPTICS&quot;</span>, optics),</span>
<span id="cb75-187"><a href="#cb75-187" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;BIRCH&quot;</span>, birch),</span>
<span id="cb75-188"><a href="#cb75-188" aria-hidden="true" tabindex="-1"></a>        (<span class="st">&quot;Gaussian</span><span class="ch">\n</span><span class="st">Mixture&quot;</span>, gmm),</span>
<span id="cb75-189"><a href="#cb75-189" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb75-190"><a href="#cb75-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-191"><a href="#cb75-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> name, algorithm <span class="kw">in</span> clustering_algorithms:</span>
<span id="cb75-192"><a href="#cb75-192" aria-hidden="true" tabindex="-1"></a>        t0 <span class="op">=</span> time.time()</span>
<span id="cb75-193"><a href="#cb75-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-194"><a href="#cb75-194" aria-hidden="true" tabindex="-1"></a>        <span class="co"># catch warnings related to kneighbors_graph</span></span>
<span id="cb75-195"><a href="#cb75-195" aria-hidden="true" tabindex="-1"></a>        <span class="cf">with</span> warnings.catch_warnings():</span>
<span id="cb75-196"><a href="#cb75-196" aria-hidden="true" tabindex="-1"></a>            warnings.filterwarnings(</span>
<span id="cb75-197"><a href="#cb75-197" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;ignore&quot;</span>,</span>
<span id="cb75-198"><a href="#cb75-198" aria-hidden="true" tabindex="-1"></a>                message<span class="op">=</span><span class="st">&quot;the number of connected components of the &quot;</span></span>
<span id="cb75-199"><a href="#cb75-199" aria-hidden="true" tabindex="-1"></a>                <span class="op">+</span> <span class="st">&quot;connectivity matrix is [0-9]{1,2}&quot;</span></span>
<span id="cb75-200"><a href="#cb75-200" aria-hidden="true" tabindex="-1"></a>                <span class="op">+</span> <span class="st">&quot; &gt; 1. Completing it to avoid stopping the tree early.&quot;</span>,</span>
<span id="cb75-201"><a href="#cb75-201" aria-hidden="true" tabindex="-1"></a>                category<span class="op">=</span><span class="pp">UserWarning</span>,</span>
<span id="cb75-202"><a href="#cb75-202" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb75-203"><a href="#cb75-203" aria-hidden="true" tabindex="-1"></a>            warnings.filterwarnings(</span>
<span id="cb75-204"><a href="#cb75-204" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;ignore&quot;</span>,</span>
<span id="cb75-205"><a href="#cb75-205" aria-hidden="true" tabindex="-1"></a>                message<span class="op">=</span><span class="st">&quot;Graph is not fully connected, spectral embedding&quot;</span></span>
<span id="cb75-206"><a href="#cb75-206" aria-hidden="true" tabindex="-1"></a>                <span class="op">+</span> <span class="st">&quot; may not work as expected.&quot;</span>,</span>
<span id="cb75-207"><a href="#cb75-207" aria-hidden="true" tabindex="-1"></a>                category<span class="op">=</span><span class="pp">UserWarning</span>,</span>
<span id="cb75-208"><a href="#cb75-208" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb75-209"><a href="#cb75-209" aria-hidden="true" tabindex="-1"></a>            algorithm.fit(X)</span>
<span id="cb75-210"><a href="#cb75-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-211"><a href="#cb75-211" aria-hidden="true" tabindex="-1"></a>        t1 <span class="op">=</span> time.time()</span>
<span id="cb75-212"><a href="#cb75-212" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">hasattr</span>(algorithm, <span class="st">&quot;labels_&quot;</span>):</span>
<span id="cb75-213"><a href="#cb75-213" aria-hidden="true" tabindex="-1"></a>            y_pred <span class="op">=</span> algorithm.labels_.astype(<span class="bu">int</span>)</span>
<span id="cb75-214"><a href="#cb75-214" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb75-215"><a href="#cb75-215" aria-hidden="true" tabindex="-1"></a>            y_pred <span class="op">=</span> algorithm.predict(X)</span>
<span id="cb75-216"><a href="#cb75-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-217"><a href="#cb75-217" aria-hidden="true" tabindex="-1"></a>        plt.subplot(<span class="bu">len</span>(datasets), <span class="bu">len</span>(clustering_algorithms), plot_num)</span>
<span id="cb75-218"><a href="#cb75-218" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i_dataset <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb75-219"><a href="#cb75-219" aria-hidden="true" tabindex="-1"></a>            plt.title(name) <span class="co"># size=18</span></span>
<span id="cb75-220"><a href="#cb75-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-221"><a href="#cb75-221" aria-hidden="true" tabindex="-1"></a>        colors <span class="op">=</span> np.array(</span>
<span id="cb75-222"><a href="#cb75-222" aria-hidden="true" tabindex="-1"></a>            <span class="bu">list</span>(</span>
<span id="cb75-223"><a href="#cb75-223" aria-hidden="true" tabindex="-1"></a>                islice(</span>
<span id="cb75-224"><a href="#cb75-224" aria-hidden="true" tabindex="-1"></a>                    cycle(</span>
<span id="cb75-225"><a href="#cb75-225" aria-hidden="true" tabindex="-1"></a>                        [</span>
<span id="cb75-226"><a href="#cb75-226" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#377eb8&quot;</span>,</span>
<span id="cb75-227"><a href="#cb75-227" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#ff7f00&quot;</span>,</span>
<span id="cb75-228"><a href="#cb75-228" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#4daf4a&quot;</span>,</span>
<span id="cb75-229"><a href="#cb75-229" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#f781bf&quot;</span>,</span>
<span id="cb75-230"><a href="#cb75-230" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#a65628&quot;</span>,</span>
<span id="cb75-231"><a href="#cb75-231" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#984ea3&quot;</span>,</span>
<span id="cb75-232"><a href="#cb75-232" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#999999&quot;</span>,</span>
<span id="cb75-233"><a href="#cb75-233" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#e41a1c&quot;</span>,</span>
<span id="cb75-234"><a href="#cb75-234" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;#dede00&quot;</span>,</span>
<span id="cb75-235"><a href="#cb75-235" aria-hidden="true" tabindex="-1"></a>                        ]</span>
<span id="cb75-236"><a href="#cb75-236" aria-hidden="true" tabindex="-1"></a>                    ),</span>
<span id="cb75-237"><a href="#cb75-237" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">int</span>(<span class="bu">max</span>(y_pred) <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb75-238"><a href="#cb75-238" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb75-239"><a href="#cb75-239" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb75-240"><a href="#cb75-240" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb75-241"><a href="#cb75-241" aria-hidden="true" tabindex="-1"></a>        <span class="co"># add black color for outliers (if any)</span></span>
<span id="cb75-242"><a href="#cb75-242" aria-hidden="true" tabindex="-1"></a>        colors <span class="op">=</span> np.append(colors, [<span class="st">&quot;#000000&quot;</span>])</span>
<span id="cb75-243"><a href="#cb75-243" aria-hidden="true" tabindex="-1"></a>        plt.scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], s<span class="op">=</span><span class="dv">10</span>, color<span class="op">=</span>colors[y_pred])</span>
<span id="cb75-244"><a href="#cb75-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-245"><a href="#cb75-245" aria-hidden="true" tabindex="-1"></a>        plt.xlim(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>)</span>
<span id="cb75-246"><a href="#cb75-246" aria-hidden="true" tabindex="-1"></a>        plt.ylim(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>)</span>
<span id="cb75-247"><a href="#cb75-247" aria-hidden="true" tabindex="-1"></a>        plt.xticks(())</span>
<span id="cb75-248"><a href="#cb75-248" aria-hidden="true" tabindex="-1"></a>        plt.yticks(())</span>
<span id="cb75-249"><a href="#cb75-249" aria-hidden="true" tabindex="-1"></a>        plt.text(</span>
<span id="cb75-250"><a href="#cb75-250" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.99</span>,</span>
<span id="cb75-251"><a href="#cb75-251" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.01</span>,</span>
<span id="cb75-252"><a href="#cb75-252" aria-hidden="true" tabindex="-1"></a>            (<span class="st">&quot;</span><span class="sc">%.2f</span><span class="st">s&quot;</span> <span class="op">%</span> (t1 <span class="op">-</span> t0)).lstrip(<span class="st">&quot;0&quot;</span>),</span>
<span id="cb75-253"><a href="#cb75-253" aria-hidden="true" tabindex="-1"></a>            transform<span class="op">=</span>plt.gca().transAxes,</span>
<span id="cb75-254"><a href="#cb75-254" aria-hidden="true" tabindex="-1"></a>            <span class="co"># size=15,</span></span>
<span id="cb75-255"><a href="#cb75-255" aria-hidden="true" tabindex="-1"></a>            horizontalalignment<span class="op">=</span><span class="st">&quot;right&quot;</span>,</span>
<span id="cb75-256"><a href="#cb75-256" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb75-257"><a href="#cb75-257" aria-hidden="true" tabindex="-1"></a>        plot_num <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb75-258"><a href="#cb75-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-259"><a href="#cb75-259" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [</span><span class="al">TODO</span><span class="co">] polish this</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Author: Jaques Grobler &lt;jaques.grobler@inria.fr&gt;</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># License: BSD 3 clause</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> time <span class="im">import</span> time</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Unused but required import for doing 3d projections with matplotlib &lt; 3.2</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> mpl_toolkits.mplot3d  <span class="co"># noqa: F401</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> NullFormatter</span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> manifold</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.utils <span class="im">import</span> check_random_state</span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables for manifold learning.</span></span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a>n_neighbors <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a>n_samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-21"><a href="#cb76-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create our sphere.</span></span>
<span id="cb76-22"><a href="#cb76-22" aria-hidden="true" tabindex="-1"></a>random_state <span class="op">=</span> check_random_state(<span class="dv">0</span>)</span>
<span id="cb76-23"><a href="#cb76-23" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> random_state.rand(n_samples) <span class="op">*</span> (<span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">-</span> <span class="fl">0.55</span>)</span>
<span id="cb76-24"><a href="#cb76-24" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> random_state.rand(n_samples) <span class="op">*</span> np.pi</span>
<span id="cb76-25"><a href="#cb76-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-26"><a href="#cb76-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sever the poles from the sphere.</span></span>
<span id="cb76-27"><a href="#cb76-27" aria-hidden="true" tabindex="-1"></a>indices <span class="op">=</span> (t <span class="op">&lt;</span> (np.pi <span class="op">-</span> (np.pi <span class="op">/</span> <span class="dv">8</span>))) <span class="op">&amp;</span> (t <span class="op">&gt;</span> ((np.pi <span class="op">/</span> <span class="dv">8</span>)))</span>
<span id="cb76-28"><a href="#cb76-28" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> p[indices]</span>
<span id="cb76-29"><a href="#cb76-29" aria-hidden="true" tabindex="-1"></a>x, y, z <span class="op">=</span> (</span>
<span id="cb76-30"><a href="#cb76-30" aria-hidden="true" tabindex="-1"></a>    np.sin(t[indices]) <span class="op">*</span> np.cos(p[indices]),</span>
<span id="cb76-31"><a href="#cb76-31" aria-hidden="true" tabindex="-1"></a>    np.sin(t[indices]) <span class="op">*</span> np.sin(p[indices]),</span>
<span id="cb76-32"><a href="#cb76-32" aria-hidden="true" tabindex="-1"></a>    np.cos(t[indices]),</span>
<span id="cb76-33"><a href="#cb76-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-34"><a href="#cb76-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-35"><a href="#cb76-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot our dataset.</span></span>
<span id="cb76-36"><a href="#cb76-36" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>)) <span class="co"># (15, 8)</span></span>
<span id="cb76-37"><a href="#cb76-37" aria-hidden="true" tabindex="-1"></a>plt.suptitle(</span>
<span id="cb76-38"><a href="#cb76-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Manifold Learning with </span><span class="sc">%i</span><span class="st"> points, </span><span class="sc">%i</span><span class="st"> neighbors&quot;</span> <span class="op">%</span> (<span class="dv">1000</span>, n_neighbors),</span>
<span id="cb76-39"><a href="#cb76-39" aria-hidden="true" tabindex="-1"></a>) <span class="co"># fontsize=14</span></span>
<span id="cb76-40"><a href="#cb76-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-41"><a href="#cb76-41" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">251</span>, projection<span class="op">=</span><span class="st">&quot;3d&quot;</span>)</span>
<span id="cb76-42"><a href="#cb76-42" aria-hidden="true" tabindex="-1"></a>ax.scatter(x, y, z, c<span class="op">=</span>p[indices], cmap<span class="op">=</span>plt.cm.rainbow)</span>
<span id="cb76-43"><a href="#cb76-43" aria-hidden="true" tabindex="-1"></a>ax.view_init(<span class="dv">40</span>, <span class="op">-</span><span class="dv">10</span>)</span>
<span id="cb76-44"><a href="#cb76-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-45"><a href="#cb76-45" aria-hidden="true" tabindex="-1"></a>sphere_data <span class="op">=</span> np.array([x, y, z]).T</span>
<span id="cb76-46"><a href="#cb76-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-47"><a href="#cb76-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Locally Linear Embedding Manifold learning</span></span>
<span id="cb76-48"><a href="#cb76-48" aria-hidden="true" tabindex="-1"></a>methods <span class="op">=</span> [<span class="st">&quot;standard&quot;</span>, <span class="st">&quot;ltsa&quot;</span>, <span class="st">&quot;hessian&quot;</span>, <span class="st">&quot;modified&quot;</span>]</span>
<span id="cb76-49"><a href="#cb76-49" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&quot;LLE&quot;</span>, <span class="st">&quot;LTSA&quot;</span>, <span class="st">&quot;Hessian LLE&quot;</span>, <span class="st">&quot;Modified LLE&quot;</span>]</span>
<span id="cb76-50"><a href="#cb76-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-51"><a href="#cb76-51" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, method <span class="kw">in</span> <span class="bu">enumerate</span>(methods):</span>
<span id="cb76-52"><a href="#cb76-52" aria-hidden="true" tabindex="-1"></a>    t0 <span class="op">=</span> time()</span>
<span id="cb76-53"><a href="#cb76-53" aria-hidden="true" tabindex="-1"></a>    trans_data <span class="op">=</span> (</span>
<span id="cb76-54"><a href="#cb76-54" aria-hidden="true" tabindex="-1"></a>        manifold.LocallyLinearEmbedding(</span>
<span id="cb76-55"><a href="#cb76-55" aria-hidden="true" tabindex="-1"></a>            n_neighbors<span class="op">=</span>n_neighbors, n_components<span class="op">=</span><span class="dv">2</span>, method<span class="op">=</span>method, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb76-56"><a href="#cb76-56" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb76-57"><a href="#cb76-57" aria-hidden="true" tabindex="-1"></a>        .fit_transform(sphere_data)</span>
<span id="cb76-58"><a href="#cb76-58" aria-hidden="true" tabindex="-1"></a>        .T</span>
<span id="cb76-59"><a href="#cb76-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb76-60"><a href="#cb76-60" aria-hidden="true" tabindex="-1"></a>    t1 <span class="op">=</span> time()</span>
<span id="cb76-61"><a href="#cb76-61" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">%s</span><span class="st">: </span><span class="sc">%.2g</span><span class="st"> sec&quot;</span> <span class="op">%</span> (methods[i], t1 <span class="op">-</span> t0))</span>
<span id="cb76-62"><a href="#cb76-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-63"><a href="#cb76-63" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">252</span> <span class="op">+</span> i)</span>
<span id="cb76-64"><a href="#cb76-64" aria-hidden="true" tabindex="-1"></a>    plt.scatter(trans_data[<span class="dv">0</span>], trans_data[<span class="dv">1</span>], c<span class="op">=</span>colors, cmap<span class="op">=</span>plt.cm.rainbow)</span>
<span id="cb76-65"><a href="#cb76-65" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&quot;</span><span class="sc">%s</span><span class="st"> (</span><span class="sc">%.2g</span><span class="st"> sec)&quot;</span> <span class="op">%</span> (labels[i], t1 <span class="op">-</span> t0))</span>
<span id="cb76-66"><a href="#cb76-66" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-67"><a href="#cb76-67" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-68"><a href="#cb76-68" aria-hidden="true" tabindex="-1"></a>    plt.axis(<span class="st">&quot;tight&quot;</span>)</span>
<span id="cb76-69"><a href="#cb76-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-70"><a href="#cb76-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Isomap Manifold learning.</span></span>
<span id="cb76-71"><a href="#cb76-71" aria-hidden="true" tabindex="-1"></a>t0 <span class="op">=</span> time()</span>
<span id="cb76-72"><a href="#cb76-72" aria-hidden="true" tabindex="-1"></a>trans_data <span class="op">=</span> (</span>
<span id="cb76-73"><a href="#cb76-73" aria-hidden="true" tabindex="-1"></a>    manifold.Isomap(n_neighbors<span class="op">=</span>n_neighbors, n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb76-74"><a href="#cb76-74" aria-hidden="true" tabindex="-1"></a>    .fit_transform(sphere_data)</span>
<span id="cb76-75"><a href="#cb76-75" aria-hidden="true" tabindex="-1"></a>    .T</span>
<span id="cb76-76"><a href="#cb76-76" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-77"><a href="#cb76-77" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> time()</span>
<span id="cb76-78"><a href="#cb76-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="sc">%s</span><span class="st">: </span><span class="sc">%.2g</span><span class="st"> sec&quot;</span> <span class="op">%</span> (<span class="st">&quot;ISO&quot;</span>, t1 <span class="op">-</span> t0))</span>
<span id="cb76-79"><a href="#cb76-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-80"><a href="#cb76-80" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">257</span>)</span>
<span id="cb76-81"><a href="#cb76-81" aria-hidden="true" tabindex="-1"></a>plt.scatter(trans_data[<span class="dv">0</span>], trans_data[<span class="dv">1</span>], c<span class="op">=</span>colors, cmap<span class="op">=</span>plt.cm.rainbow)</span>
<span id="cb76-82"><a href="#cb76-82" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;</span><span class="sc">%s</span><span class="st"> (</span><span class="sc">%.2g</span><span class="st"> sec)&quot;</span> <span class="op">%</span> (<span class="st">&quot;Isomap&quot;</span>, t1 <span class="op">-</span> t0))</span>
<span id="cb76-83"><a href="#cb76-83" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-84"><a href="#cb76-84" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-85"><a href="#cb76-85" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&quot;tight&quot;</span>)</span>
<span id="cb76-86"><a href="#cb76-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-87"><a href="#cb76-87" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Multi-dimensional scaling.</span></span>
<span id="cb76-88"><a href="#cb76-88" aria-hidden="true" tabindex="-1"></a>t0 <span class="op">=</span> time()</span>
<span id="cb76-89"><a href="#cb76-89" aria-hidden="true" tabindex="-1"></a>mds <span class="op">=</span> manifold.MDS(<span class="dv">2</span>, max_iter<span class="op">=</span><span class="dv">100</span>, n_init<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb76-90"><a href="#cb76-90" aria-hidden="true" tabindex="-1"></a>trans_data <span class="op">=</span> mds.fit_transform(sphere_data).T</span>
<span id="cb76-91"><a href="#cb76-91" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> time()</span>
<span id="cb76-92"><a href="#cb76-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;MDS: </span><span class="sc">%.2g</span><span class="st"> sec&quot;</span> <span class="op">%</span> (t1 <span class="op">-</span> t0))</span>
<span id="cb76-93"><a href="#cb76-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-94"><a href="#cb76-94" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">258</span>)</span>
<span id="cb76-95"><a href="#cb76-95" aria-hidden="true" tabindex="-1"></a>plt.scatter(trans_data[<span class="dv">0</span>], trans_data[<span class="dv">1</span>], c<span class="op">=</span>colors, cmap<span class="op">=</span>plt.cm.rainbow)</span>
<span id="cb76-96"><a href="#cb76-96" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;MDS (</span><span class="sc">%.2g</span><span class="st"> sec)&quot;</span> <span class="op">%</span> (t1 <span class="op">-</span> t0))</span>
<span id="cb76-97"><a href="#cb76-97" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-98"><a href="#cb76-98" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-99"><a href="#cb76-99" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&quot;tight&quot;</span>)</span>
<span id="cb76-100"><a href="#cb76-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-101"><a href="#cb76-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Spectral Embedding.</span></span>
<span id="cb76-102"><a href="#cb76-102" aria-hidden="true" tabindex="-1"></a>t0 <span class="op">=</span> time()</span>
<span id="cb76-103"><a href="#cb76-103" aria-hidden="true" tabindex="-1"></a>se <span class="op">=</span> manifold.SpectralEmbedding(</span>
<span id="cb76-104"><a href="#cb76-104" aria-hidden="true" tabindex="-1"></a>    n_components<span class="op">=</span><span class="dv">2</span>, n_neighbors<span class="op">=</span>n_neighbors, random_state<span class="op">=</span><span class="dv">42</span></span>
<span id="cb76-105"><a href="#cb76-105" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-106"><a href="#cb76-106" aria-hidden="true" tabindex="-1"></a>trans_data <span class="op">=</span> se.fit_transform(sphere_data).T</span>
<span id="cb76-107"><a href="#cb76-107" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> time()</span>
<span id="cb76-108"><a href="#cb76-108" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Spectral Embedding: </span><span class="sc">%.2g</span><span class="st"> sec&quot;</span> <span class="op">%</span> (t1 <span class="op">-</span> t0))</span>
<span id="cb76-109"><a href="#cb76-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-110"><a href="#cb76-110" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">259</span>)</span>
<span id="cb76-111"><a href="#cb76-111" aria-hidden="true" tabindex="-1"></a>plt.scatter(trans_data[<span class="dv">0</span>], trans_data[<span class="dv">1</span>], c<span class="op">=</span>colors, cmap<span class="op">=</span>plt.cm.rainbow)</span>
<span id="cb76-112"><a href="#cb76-112" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Spectral Embedding (</span><span class="sc">%.2g</span><span class="st"> sec)&quot;</span> <span class="op">%</span> (t1 <span class="op">-</span> t0))</span>
<span id="cb76-113"><a href="#cb76-113" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-114"><a href="#cb76-114" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-115"><a href="#cb76-115" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&quot;tight&quot;</span>)</span>
<span id="cb76-116"><a href="#cb76-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-117"><a href="#cb76-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform t-distributed stochastic neighbor embedding.</span></span>
<span id="cb76-118"><a href="#cb76-118" aria-hidden="true" tabindex="-1"></a>t0 <span class="op">=</span> time()</span>
<span id="cb76-119"><a href="#cb76-119" aria-hidden="true" tabindex="-1"></a>tsne <span class="op">=</span> manifold.TSNE(n_components<span class="op">=</span><span class="dv">2</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb76-120"><a href="#cb76-120" aria-hidden="true" tabindex="-1"></a>trans_data <span class="op">=</span> tsne.fit_transform(sphere_data).T</span>
<span id="cb76-121"><a href="#cb76-121" aria-hidden="true" tabindex="-1"></a>t1 <span class="op">=</span> time()</span>
<span id="cb76-122"><a href="#cb76-122" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;t-SNE: </span><span class="sc">%.2g</span><span class="st"> sec&quot;</span> <span class="op">%</span> (t1 <span class="op">-</span> t0))</span>
<span id="cb76-123"><a href="#cb76-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-124"><a href="#cb76-124" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb76-125"><a href="#cb76-125" aria-hidden="true" tabindex="-1"></a>plt.scatter(trans_data[<span class="dv">0</span>], trans_data[<span class="dv">1</span>], c<span class="op">=</span>colors, cmap<span class="op">=</span>plt.cm.rainbow)</span>
<span id="cb76-126"><a href="#cb76-126" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;t-SNE (</span><span class="sc">%.2g</span><span class="st"> sec)&quot;</span> <span class="op">%</span> (t1 <span class="op">-</span> t0))</span>
<span id="cb76-127"><a href="#cb76-127" aria-hidden="true" tabindex="-1"></a>ax.xaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-128"><a href="#cb76-128" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(NullFormatter())</span>
<span id="cb76-129"><a href="#cb76-129" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&quot;tight&quot;</span>)</span>
<span id="cb76-130"><a href="#cb76-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-131"><a href="#cb76-131" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
